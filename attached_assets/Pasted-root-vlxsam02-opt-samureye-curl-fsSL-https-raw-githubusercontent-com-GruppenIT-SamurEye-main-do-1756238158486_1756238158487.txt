root@vlxsam02:/opt/samureye# curl -fsSL https://raw.githubusercontent.com/GruppenIT/SamurEye/main/docs/deployment/vlxsam02/install.sh | bash
[2025-08-26 16:51:06] ðŸš€ Iniciando instalaÃ§Ã£o do SamurEye Application Server (vlxsam02)...
[2025-08-26 16:51:06] ðŸ” Executando validaÃ§Ã£o de seguranÃ§a do script...
[2025-08-26 16:51:06] VerificaÃ§Ã£o de pacotes problemÃ¡ticos: OK (wscat serÃ¡ instalado via npm)
[2025-08-26 16:51:06] INFO: ðŸ“‹ Configurando sistema base...
[2025-08-26 16:51:06] Atualizando sistema Ubuntu...
Hit:1 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:2 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:3 http://archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:4 http://archive.ubuntu.com/ubuntu noble-backports InRelease
Hit:5 https://deb.nodesource.com/node_20.x nodistro InRelease
Reading package lists... Done
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
Calculating upgrade... Done
The following packages have been kept back:
  sosreport
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:09] Configurando timezone para America/Sao_Paulo...
[2025-08-26 16:51:09] Instalando pacotes essenciais...
[2025-08-26 16:51:09] Instalando pacotes bÃ¡sicos do sistema...
[2025-08-26 16:51:09] Verificando disponibilidade: curl
[2025-08-26 16:51:09] Instalando curl...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
curl is already the newest version (8.5.0-2ubuntu10.6).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:09] âœ… curl instalado com sucesso
[2025-08-26 16:51:09] Verificando disponibilidade: wget
[2025-08-26 16:51:09] Instalando wget...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
wget is already the newest version (1.21.4-1ubuntu4.1).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:10] âœ… wget instalado com sucesso
[2025-08-26 16:51:10] Verificando disponibilidade: git
[2025-08-26 16:51:10] Instalando git...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
git is already the newest version (1:2.43.0-1ubuntu7.3).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:10] âœ… git instalado com sucesso
[2025-08-26 16:51:10] Verificando disponibilidade: build-essential
[2025-08-26 16:51:10] Instalando build-essential...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
build-essential is already the newest version (12.10ubuntu1).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:11] âœ… build-essential instalado com sucesso
[2025-08-26 16:51:11] Verificando disponibilidade: python3
[2025-08-26 16:51:11] Instalando python3...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
python3 is already the newest version (3.12.3-0ubuntu2).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:11] âœ… python3 instalado com sucesso
[2025-08-26 16:51:11] Verificando disponibilidade: python3-pip
[2025-08-26 16:51:11] Instalando python3-pip...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
python3-pip is already the newest version (24.0+dfsg-1ubuntu1.2).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:12] âœ… python3-pip instalado com sucesso
[2025-08-26 16:51:12] Verificando disponibilidade: htop
[2025-08-26 16:51:12] Instalando htop...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
htop is already the newest version (3.3.0-4build1).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:12] âœ… htop instalado com sucesso
[2025-08-26 16:51:12] Verificando disponibilidade: unzip
[2025-08-26 16:51:12] Instalando unzip...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
unzip is already the newest version (6.0-28ubuntu4.1).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:13] âœ… unzip instalado com sucesso
[2025-08-26 16:51:13] Verificando disponibilidade: software-properties-common
[2025-08-26 16:51:13] Instalando software-properties-common...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
software-properties-common is already the newest version (0.99.49.3).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:13] âœ… software-properties-common instalado com sucesso
[2025-08-26 16:51:13] Verificando disponibilidade: ufw
[2025-08-26 16:51:13] Instalando ufw...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
ufw is already the newest version (0.36.2-6).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:14] âœ… ufw instalado com sucesso
[2025-08-26 16:51:14] Verificando disponibilidade: fail2ban
[2025-08-26 16:51:14] Instalando fail2ban...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
fail2ban is already the newest version (1.0.2-3ubuntu0.1).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:14] âœ… fail2ban instalado com sucesso
[2025-08-26 16:51:14] Verificando disponibilidade: supervisor
[2025-08-26 16:51:14] Instalando supervisor...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
supervisor is already the newest version (4.2.5-1ubuntu0.1).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:14] âœ… supervisor instalado com sucesso
[2025-08-26 16:51:14] Verificando disponibilidade: sqlite3
[2025-08-26 16:51:14] Instalando sqlite3...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
sqlite3 is already the newest version (3.45.1-1ubuntu2.4).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:15] âœ… sqlite3 instalado com sucesso
[2025-08-26 16:51:15] Verificando disponibilidade: ca-certificates
[2025-08-26 16:51:15] Instalando ca-certificates...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
ca-certificates is already the newest version (20240203).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:15] âœ… ca-certificates instalado com sucesso
[2025-08-26 16:51:15] Verificando disponibilidade: gnupg
[2025-08-26 16:51:15] Instalando gnupg...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
gnupg is already the newest version (2.4.4-2ubuntu17.3).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:16] âœ… gnupg instalado com sucesso
[2025-08-26 16:51:16] Verificando disponibilidade: lsb-release
[2025-08-26 16:51:16] Instalando lsb-release...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
lsb-release is already the newest version (12.0-2).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:16] âœ… lsb-release instalado com sucesso
[2025-08-26 16:51:16] Instalando cliente PostgreSQL...
[2025-08-26 16:51:16] ðŸ‘¤ Configurando usuÃ¡rio samureye...
[2025-08-26 16:51:16] UsuÃ¡rio samureye jÃ¡ existe
[2025-08-26 16:51:16] Senha definida para o usuÃ¡rio samureye
[2025-08-26 16:51:17] ðŸ“¦ Instalando Node.js 20.x LTS...
2025-08-26 16:51:17 - Installing pre-requisites
Hit:1 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:2 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:3 http://archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:4 http://archive.ubuntu.com/ubuntu noble-backports InRelease
Hit:5 https://deb.nodesource.com/node_20.x nodistro InRelease
Reading package lists... Done
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
apt-transport-https is already the newest version (2.8.3).
ca-certificates is already the newest version (20240203).
curl is already the newest version (8.5.0-2ubuntu10.6).
gnupg is already the newest version (2.4.4-2ubuntu17.3).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
Hit:1 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:2 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:3 http://archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:4 http://archive.ubuntu.com/ubuntu noble-backports InRelease
Hit:5 https://deb.nodesource.com/node_20.x nodistro InRelease
Reading package lists... Done
2025-08-26 16:51:22 - Repository configured successfully.
2025-08-26 16:51:22 - To install Node.js, run: apt-get install nodejs -y
2025-08-26 16:51:22 - You can use N|solid Runtime as a node.js alternative
2025-08-26 16:51:22 - To install N|solid Runtime, run: apt-get install nsolid -y

Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
nodejs is already the newest version (20.19.4-1nodesource1).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:23] Node.js: v20.19.4, NPM: 10.8.2
[2025-08-26 16:51:23] Configurando ambiente de desenvolvimento...

changed 6 packages in 3s

2 packages are looking for funding
  run `npm fund` for details
npm warn using --force Recommended protections disabled.
[2025-08-26 16:51:26] PM2 substituÃ­do por systemd service
[2025-08-26 16:51:26] ðŸ”¥ Configurando firewall UFW...
Default incoming policy changed to 'deny'
(be sure to update your rules accordingly)
Default outgoing policy changed to 'allow'
(be sure to update your rules accordingly)
Skipping adding existing rule
Skipping adding existing rule (v6)
Skipping adding existing rule
Skipping adding existing rule (v6)
Firewall is active and enabled on system startup
[2025-08-26 16:51:29] Firewall configurado: SSH (22), App (5000)
[2025-08-26 16:51:29] ðŸ”§ Instalando ferramentas de seguranÃ§a e cliente PostgreSQL...
[2025-08-26 16:51:29] Instalando ferramentas de rede e banco...
[2025-08-26 16:51:29] Verificando disponibilidade: redis-tools
[2025-08-26 16:51:29] Instalando redis-tools...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
redis-tools is already the newest version (5:7.0.15-1ubuntu0.24.04.1).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:29] âœ… redis-tools instalado com sucesso
[2025-08-26 16:51:29] Verificando disponibilidade: dnsutils
[2025-08-26 16:51:29] Instalando dnsutils...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
dnsutils is already the newest version (1:9.18.30-0ubuntu0.24.04.2).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:30] âœ… dnsutils instalado com sucesso
[2025-08-26 16:51:30] Verificando disponibilidade: netcat-openbsd
[2025-08-26 16:51:30] Instalando netcat-openbsd...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
netcat-openbsd is already the newest version (1.226-1ubuntu2).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:30] âœ… netcat-openbsd instalado com sucesso
[2025-08-26 16:51:30] Instalando ferramentas de seguranÃ§a...
[2025-08-26 16:51:30] Verificando disponibilidade: nmap
[2025-08-26 16:51:30] Instalando nmap...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
nmap is already the newest version (7.94+git20230807.3be01efb1+dfsg-3build2).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:31] âœ… nmap instalado com sucesso
[2025-08-26 16:51:31] Verificando disponibilidade: masscan
[2025-08-26 16:51:31] Instalando masscan...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
masscan is already the newest version (2:1.3.2+ds1-1).
0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.
[2025-08-26 16:51:31] âœ… masscan instalado com sucesso
[2025-08-26 16:51:31] Instalando Nuclei...
[2025-08-26 16:51:33] âœ… Nuclei instalado com sucesso
[2025-08-26 16:51:33] Instalando wscat via npm...

changed 9 packages in 2s
[2025-08-26 16:51:36] Verificando ferramentas instaladas...
Nmap version 7.94SVN ( https://nmap.org )
[INF] Nuclei Engine Version: v3.2.9
[INF] Nuclei Config Directory: /root/.config/nuclei
[INF] Nuclei Cache Directory: /root/.cache/nuclei
[INF] PDCP Directory: /root/.pdcp

Masscan version 1.3.2 ( https://github.com/robertdavidgraham/masscan )
Compiled on: Feb  2 2021 11:13:27
Compiler: gcc 10.2.1 20210130
OS: Linux
CPU: unknown (64 bits)
GIT version: unknown
[2025-08-26 16:51:36] Masscan nÃ£o instalado
[2025-08-26 16:51:36] wscat instalado
[INF] Nuclei Engine Version: v3.2.9
[INF] Nuclei Config Directory: /root/.config/nuclei
[INF] Nuclei Cache Directory: /root/.cache/nuclei
[INF] PDCP Directory: /root/.pdcp


                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.2.9

                projectdiscovery.io

[INF] No new updates found for nuclei templates
[2025-08-26 16:51:36] ðŸ“ Configurando cÃ³digo da aplicaÃ§Ã£o...
[2025-08-26 16:51:36] DiretÃ³rio da aplicaÃ§Ã£o jÃ¡ existe
[2025-08-26 16:51:36] âš™ï¸ Configurando variÃ¡veis de ambiente...
[2025-08-26 16:51:36] âœ… Arquivo .env criado com permissÃµes corretas (samureye:samureye 644)
-rw-r--r-- 1 samureye samureye 2326 Aug 26 16:51 /etc/samureye/.env
[2025-08-26 16:51:36] âš¡ Configurando systemd service...
[2025-08-26 16:51:37] Systemd service configurado e habilitado
[2025-08-26 16:51:37] ðŸ“¦ Configurando aplicaÃ§Ã£o SamurEye...
[2025-08-26 16:51:37] Nota: dependÃªncias serÃ£o instaladas apÃ³s clonagem do cÃ³digo fonte
[2025-08-26 16:51:37] ðŸ“Š Criando scripts de monitoramento...
[2025-08-26 16:51:37] âš™ï¸ Finalizando instalaÃ§Ã£o...
[2025-08-26 16:51:37] Systemd service configurado
[2025-08-26 16:51:37] ðŸ“ Configurando logrotate...
[2025-08-26 16:51:37] â° Configurando cron jobs...
[2025-08-26 16:51:37] ðŸ›¡ï¸ Configurando Fail2Ban...
Synchronizing state of fail2ban.service with SysV service script with /usr/lib/systemd/systemd-sysv-install.
Executing: /usr/lib/systemd/systemd-sysv-install enable fail2ban
[2025-08-26 16:51:37] ðŸ“‹ Criando arquivo de credenciais...
[2025-08-26 16:51:37] ðŸš€ Executando automaÃ§Ã£o completa da instalaÃ§Ã£o...
[2025-08-26 16:51:37] ðŸ“‚ Clonando cÃ³digo da aplicaÃ§Ã£o...
[2025-08-26 16:51:37] Removendo instalaÃ§Ã£o anterior...
Cloning into '/opt/samureye/SamurEye'...
remote: Enumerating objects: 1101, done.
remote: Counting objects: 100% (67/67), done.
remote: Compressing objects: 100% (37/37), done.
remote: Total 1101 (delta 39), reused 50 (delta 23), pack-reused 1034 (from 1)
Receiving objects: 100% (1101/1101), 897.31 KiB | 5.41 MiB/s, done.
Resolving deltas: 100% (713/713), done.
[2025-08-26 16:51:39] ðŸ“¦ Instalando dependÃªncias da aplicaÃ§Ã£o...
[16:51:39] ðŸ“¦ Instalando dependÃªncias Node.js...
npm warn using --force Recommended protections disabled.
[16:51:39] Executando npm install...
npm warn deprecated node-domexception@1.0.0: Use your platform's native DOMException instead
npm warn deprecated @esbuild-kit/esm-loader@2.6.5: Merged into tsx: https://tsx.is
npm warn deprecated @esbuild-kit/core-utils@3.3.2: Merged into tsx: https://tsx.is

added 644 packages, and audited 645 packages in 2m

90 packages are looking for funding
  run `npm fund` for details

5 moderate severity vulnerabilities

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
[16:53:17] Verificando TypeScript...
[16:53:18] âœ… TypeScript funciona
[16:53:18] âœ… DependÃªncias instaladas com sucesso!
[16:53:18] Execute 'npm run dev' para iniciar a aplicaÃ§Ã£o
[2025-08-26 16:53:18] ðŸ”§ Configurando variÃ¡veis de ambiente para db:push...
[2025-08-26 16:53:18] ðŸ—„ï¸ Executando migraÃ§Ãµes do banco de dados...
/etc/samureye/.env: line 45: Integration: command not found

> rest-express@1.0.0 db:push
> drizzle-kit push

No config path provided, using default 'drizzle.config.ts'
Reading config file '/opt/samureye/SamurEye/drizzle.config.ts'
DATABASE_URL, ensure the database is provisioned
[2025-08-26 16:53:18] AVISO: Falha na migraÃ§Ã£o do banco - configure manualmente
[2025-08-26 16:53:18] ðŸš€ Iniciando aplicaÃ§Ã£o...
[2025-08-26 16:53:23] âœ… ServiÃ§o samureye-app: INICIADO COM SUCESSO
[2025-08-26 16:53:23] âœ… InstalaÃ§Ã£o automatizada do vlxsam02 concluÃ­da com sucesso!

ðŸ“‹ VERIFICAÃ‡ÃƒO FINAL:
===================

Status da aplicaÃ§Ã£o:
â— samureye-app.service - SamurEye Application (React 18 + Vite + Node.js)
     Loaded: loaded (/etc/systemd/system/samureye-app.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 16:53:18 -03; 5s ago
   Main PID: 79688 (npm run dev)
      Tasks: 51 (limit: 9443)
     Memory: 711.5M (peak: 711.8M)
        CPU: 5.499s
     CGroup: /system.slice/samureye-app.service
             â”œâ”€79688 "npm run dev"
             â”œâ”€79700 sh -c "NODE_ENV=development tsx server/index.ts"
             â”œâ”€79701 node /opt/samureye/SamurEye/node_modules/.bin/tsx server/index.ts
             â”œâ”€79712 /usr/bin/node --require /opt/samureye/SamurEye/node_modules/tsx/dist/preflight.cjs --import file:///opt/samureye/SamurEye/node_modules/tsx/dist/loader.mjs server/index.ts
             â”œâ”€79724 /opt/samureye/SamurEye/node_modules/@esbuild/linux-x64/bin/esbuild --service=0.25.9 --ping
             â””â”€79732 /opt/samureye/SamurEye/node_modules/vite/node_modules/@esbuild/linux-x64/bin/esbuild --service=0.21.5 --ping

Aug 26 16:53:18 vlxsam02 systemd[1]: Started samureye-app.service - SamurEye Application (React 18 + Vite + Node.js).
Aug 26 16:53:18 vlxsam02 samureye-app[79688]: > rest-express@1.0.0 dev
Aug 26 16:53:18 vlxsam02 samureye-app[79688]: > NODE_ENV=development tsx server/index.ts
Aug 26 16:53:20 vlxsam02 samureye-app[79712]: 4:53:20 PM [express] serving on port 5000

Verificar instalaÃ§Ã£o:
   /opt/samureye/scripts/health-check.sh
   /opt/samureye/scripts/test-connectivity.sh

ðŸŽ¯ CREDENCIAIS:
   UsuÃ¡rio: samureye
   Senha: SamurEye2024!
   Detalhes: /opt/samureye/CREDENTIALS.txt

ðŸŒ ENDPOINTS LOCAIS:
   App Unificado: http://localhost:5000
   API: http://localhost:5000/api
   Health: http://localhost:5000/api/health

âš ï¸  IMPORTANTE:
   - Configure /etc/samureye/.env com dados reais
   - Instale o cÃ³digo da aplicaÃ§Ã£o
   - Teste conectividade com vlxsam03 (database)

[2025-08-26 16:53:23] ðŸ” Executando validaÃ§Ã£o final da instalaÃ§Ã£o...

=== RELATÃ“RIO DE VALIDAÃ‡ÃƒO ===

ðŸ”§ Comandos e Ferramentas:
[2025-08-26 16:53:23] âœ… Node.js: OK
[2025-08-26 16:53:23] âœ… NPM: OK
[2025-08-26 16:53:23] âœ… TSX: OK
[2025-08-26 16:53:23] âœ… Git: OK
[2025-08-26 16:53:23] âœ… PostgreSQL Client: OK
[2025-08-26 16:53:23] âœ… Redis Client: OK
[2025-08-26 16:53:23] âœ… Nmap: OK
[2025-08-26 16:53:23] âœ… Nuclei: OK
[2025-08-26 16:53:23] âœ… Masscan: OK
[2025-08-26 16:53:23] âœ… WebSocket CLI: OK

ðŸ› ï¸ ServiÃ§os do Sistema:
[2025-08-26 16:53:23] âœ… ServiÃ§o ufw: ATIVO
[2025-08-26 16:53:23] âœ… ServiÃ§o fail2ban: ATIVO
[2025-08-26 16:53:23] âœ… ServiÃ§o supervisor: ATIVO

ðŸ“ Estrutura de DiretÃ³rios:
[2025-08-26 16:53:23] âœ… DiretÃ³rio App Directory: OK (/opt/samureye)
[2025-08-26 16:53:23] âœ… DiretÃ³rio Log Directory: OK (/var/log/samureye)
[2025-08-26 16:53:23] âœ… DiretÃ³rio Scripts Directory: OK (/opt/samureye/scripts)
[2025-08-26 16:53:23] âœ… DiretÃ³rio Config Directory: OK (/etc/samureye)

ðŸ“„ Arquivos de ConfiguraÃ§Ã£o:
[2025-08-26 16:53:23] âœ… VariÃ¡veis de Ambiente: OK
[2025-08-26 16:53:23] âœ… Credenciais: OK
[2025-08-26 16:53:23] âœ… Package.json: OK
[2025-08-26 16:53:23] âœ… Vite Config: OK
[2025-08-26 16:53:23] âœ… Systemd Service: OK
[2025-08-26 16:53:23] âœ… Health Check: OK
[2025-08-26 16:53:23] âœ… Test Connectivity: OK

ðŸ‘¤ UsuÃ¡rio e PermissÃµes:
[2025-08-26 16:53:23] âœ… UsuÃ¡rio samureye: EXISTS
[2025-08-26 16:53:23] âœ… UsuÃ¡rio samureye: HAS SUDO

ðŸŒ VerificaÃ§Ã£o de Ports:
[2025-08-26 16:53:23] âœ… Porta 5000: DISPONÃVEL PARA BIND
[2025-08-26 16:53:23] ðŸ”§ Verificando correÃ§Ãµes aplicadas...

ðŸ“ VerificaÃ§Ã£o de PermissÃµes do .env:
[2025-08-26 16:53:23] PermissÃµes atuais: -rw-r--r-- samureye samureye
[2025-08-26 16:53:23] âœ… Owner correto: samureye:samureye
[2025-08-26 16:53:23] âœ… PermissÃµes corretas: 644 (rw-r--r--)

ðŸŒ VerificaÃ§Ã£o de URLs no .env:
[2025-08-26 16:53:23] âœ… FRONTEND_URL: Correta (http://172.24.1.152:5000)
[2025-08-26 16:53:23] âœ… VITE_API_BASE_URL: Correta (http://172.24.1.152:5000)
[2025-08-26 16:53:23] âœ… CORS_ORIGINS: Correta (http://172.24.1.152:5000)

ðŸ”— Conectividade BÃ¡sica:
[2025-08-26 16:53:23] âœ… Conectividade Internet: OK
[2025-08-26 16:53:23] âœ… Conectividade vlxsam03: OK

=== FIM DA VALIDAÃ‡ÃƒO ===

[2025-08-26 16:53:23] ðŸ”„ REINSTALAÃ‡ÃƒO DETECTADA - Script executado como mecanismo de reset
[2025-08-26 16:53:23] ðŸ“Š InstalaÃ§Ã£o vlxsam02 completada com validaÃ§Ã£o!
[2025-08-26 16:53:23] ðŸ“– Consulte: /opt/samureye/CREDENTIALS.txt para prÃ³ximos passos
root@vlxsam02:/opt/samureye# systemctl status samureye-app
â— samureye-app.service - SamurEye Application (React 18 + Vite + Node.js)
     Loaded: loaded (/etc/systemd/system/samureye-app.service; enabled; preset: enabled)
     Active: active (running) since Tue 2025-08-26 16:53:18 -03; 59s ago
   Main PID: 79688 (npm run dev)
      Tasks: 51 (limit: 9443)
     Memory: 481.3M (peak: 713.6M)
        CPU: 5.882s
     CGroup: /system.slice/samureye-app.service
             â”œâ”€79688 "npm run dev"
             â”œâ”€79700 sh -c "NODE_ENV=development tsx server/index.ts"
             â”œâ”€79701 node /opt/samureye/SamurEye/node_modules/.bin/tsx server/index.ts
             â”œâ”€79712 /usr/bin/node --require /opt/samureye/SamurEye/node_modules/tsx/dist/preflight.cjs --import file:///opt/samureye/SamurEye/node_modules/tsx/dist/loader.mjs server/index.ts
             â”œâ”€79724 /opt/samureye/SamurEye/node_modules/@esbuild/linux-x64/bin/esbuild --service=0.25.9 --ping
             â””â”€79732 /opt/samureye/SamurEye/node_modules/vite/node_modules/@esbuild/linux-x64/bin/esbuild --service=0.21.5 --ping

Aug 26 16:53:18 vlxsam02 systemd[1]: Started samureye-app.service - SamurEye Application (React 18 + Vite + Node.js).
Aug 26 16:53:18 vlxsam02 samureye-app[79688]: > rest-express@1.0.0 dev
Aug 26 16:53:18 vlxsam02 samureye-app[79688]: > NODE_ENV=development tsx server/index.ts
Aug 26 16:53:20 vlxsam02 samureye-app[79712]: 4:53:20 PM [express] serving on port 5000
root@vlxsam02:/opt/samureye# curl http://localhost:5000/api/admin/stats
{"message":"Acesso negado - Admin apenas"}root@vlxsam02:/opt/samureye#
root@vlxsam02:/opt/samureye# curl http://localhost:5000/api/system/settingscurl http://localhost:5000/api/system/settings
<!DOCTYPE html>
<html lang="en">
  <head>
    <script type="module">
import { createHotContext } from "/@vite/client";
const hot = createHotContext("/__dummy__runtime-error-plugin");

function sendError(error) {
  if (!(error instanceof Error)) {
    error = new Error("(unknown runtime error)");
  }
  const serialized = {
    message: error.message,
    stack: error.stack,
  };
  hot.send("runtime-error-plugin:error", serialized);
}

window.addEventListener("error", (evt) => {
  sendError(evt.error);
});

window.addEventListener("unhandledrejection", (evt) => {
  sendError(evt.reason);
});
</script>

    <script type="module">import { injectIntoGlobalHook } from "/@react-refresh";
injectIntoGlobalHook(window);
window.$RefreshReg$ = () => {};
window.$RefreshSig$ = () => (type) => type;</script>

    <script type="module" src="/@vite/client"></script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Architects+Daughter&family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=Fira+Code:wght@300..700&family=Geist+Mono:wght@100..900&family=Geist:wght@100..900&family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=IBM+Plex+Sans:ital,wght@0,100..700;1,100..700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Lora:ital,wght@0,400..700;1,400..700&family=Merriweather:ital,opsz,wght@0,18..144,300..900;1,18..144,300..900&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Outfit:wght@100..900&family=Oxanium:wght@200..800&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto+Mono:ital,wght@0,100..700;1,100..700&family=Roboto:ital,wght@0,100..900;1,100..900&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&family=Source+Serif+4:ital,opsz,wght@0,8..60,200..900;1,8..60,200..900&family=Space+Grotesk:wght@300..700&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <script type="module">"use strict";(()=>{var P="0.2.8";var T={HIGHLIGHT_COLOR:"#0079F2",HIGHLIGHT_BG:"#0079F210",ALLOWED_DOMAIN:".replit.dev"},Q=`
  [contenteditable] {
    outline: none !important;
  }

  [contenteditable]:focus {
    outline: none !important;
  }
`,Z=`
  .beacon-highlighter {
    content: '';
    position: absolute;
    z-index: ${Number.MAX_SAFE_INTEGER-3};
    box-sizing: border-box;
    pointer-events: none;
    outline: 2px dashed ${T.HIGHLIGHT_COLOR} !important;
    outline-offset: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    transform: none !important;
    background: ${T.HIGHLIGHT_BG} !important;
    opacity: 0;
  }

  .beacon-hover-highlighter {
    position: fixed;
    z-index: ${Number.MAX_SAFE_INTEGER};
  }

  .beacon-selected-highlighter {
    position: fixed;
    pointer-events: none;
    outline: 2px solid ${T.HIGHLIGHT_COLOR} !important;
    outline-offset: 3px !important;
    background: none !important;
  }

  .beacon-label {
    position: absolute;
    background-color: ${T.HIGHLIGHT_COLOR};
    color: #FFFFFF;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 14px;
    font-family: monospace;
    line-height: 1;
    white-space: nowrap;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    transform: translateY(-100%);
    margin-top: -4px;
    left: 0;
    z-index: ${Number.MAX_SAFE_INTEGER-2};
    pointer-events: none;
    opacity: 0;
  }

  .beacon-hover-label {
    position: fixed;
    z-index: ${Number.MAX_SAFE_INTEGER};
  }

  .beacon-selected-label {
    position: fixed;
    pointer-events: none;
  }

  .beacon-sibling-highlighter {
    position: fixed;
    pointer-events: none;
    outline: 2px dashed ${T.HIGHLIGHT_COLOR} !important;
    outline-offset: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    transform: none !important;
    background: ${T.HIGHLIGHT_BG} !important;
  }
`;function Ne(e,i){return e[13]=1,e[14]=i>>8,e[15]=i&255,e[16]=i>>8,e[17]=i&255,e}var oe=112,le=72,ae=89,ce=115,W;function De(){let e=new Int32Array(256);for(let i=0;i<256;i++){let t=i;for(let n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[i]=t}return e}function Ie(e){let i=-1;W||(W=De());for(let t=0;t<e.length;t++)i=W[(i^e[t])&255]^i>>>8;return i^-1}function Me(e){let i=e.length-1;for(let t=i;t>=4;t--)if(e[t-4]===9&&e[t-3]===oe&&e[t-2]===le&&e[t-1]===ae&&e[t]===ce)return t-3;return 0}function Re(e,i,t=!1){let n=new Uint8Array(13);i*=39.3701,n[0]=oe,n[1]=le,n[2]=ae,n[3]=ce,n[4]=i>>>24,n[5]=i>>>16,n[6]=i>>>8,n[7]=i&255,n[8]=n[4],n[9]=n[5],n[10]=n[6],n[11]=n[7],n[12]=1;let o=Ie(n),r=new Uint8Array(4);if(r[0]=o>>>24,r[1]=o>>>16,r[2]=o>>>8,r[3]=o&255,t){let l=Me(e);return e.set(n,l),e.set(r,l+13),e}else{let l=new Uint8Array(4);l[0]=0,l[1]=0,l[2]=0,l[3]=9;let s=new Uint8Array(54);return s.set(e,0),s.set(l,33),s.set(n,37),s.set(r,50),s}}var he="[modern-screenshot]",C=typeof window<"u",_e=C&&"Worker"in window,Oe=C&&"atob"in window,qt=C&&"btoa"in window,V=C?window.navigator?.userAgent:"",de=V.includes("Chrome"),k=V.includes("AppleWebKit")&&!de,q=V.includes("Firefox"),Pe=e=>e&&"__CONTEXT__"in e,ke=e=>e.constructor.name==="CSSFontFaceRule",Fe=e=>e.constructor.name==="CSSImportRule",y=e=>e.nodeType===1,I=e=>typeof e.className=="object",ge=e=>e.tagName==="image",Ue=e=>e.tagName==="use",x=e=>y(e)&&typeof e.style<"u"&&!I(e),$e=e=>e.nodeType===8,Be=e=>e.nodeType===3,L=e=>e.tagName==="IMG",F=e=>e.tagName==="VIDEO",We=e=>e.tagName==="CANVAS",Ge=e=>e.tagName==="TEXTAREA",Ve=e=>e.tagName==="INPUT",qe=e=>e.tagName==="STYLE",je=e=>e.tagName==="SCRIPT",ze=e=>e.tagName==="SELECT",Xe=e=>e.tagName==="SLOT",Ye=e=>e.tagName==="IFRAME",Ke=(...e)=>console.warn(he,...e);function Je(e){let i=e?.createElement?.("canvas");return i&&(i.height=i.width=1),!!i&&"toDataURL"in i&&!!i.toDataURL("image/webp").includes("image/webp")}var G=e=>e.startsWith("data:");function ue(e,i){if(e.match(/^[a-z]+:\/\//i))return e;if(C&&e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i)||!C)return e;let t=U().implementation.createHTMLDocument(),n=t.createElement("base"),o=t.createElement("a");return t.head.appendChild(n),t.body.appendChild(o),i&&(n.href=i),o.href=e,o.href}function U(e){return(e&&y(e)?e?.ownerDocument:e)??window.document}var $="http://www.w3.org/2000/svg";function Qe(e,i,t){let n=U(t).createElementNS($,"svg");return n.setAttributeNS(null,"width",e.toString()),n.setAttributeNS(null,"height",i.toString()),n.setAttributeNS(null,"viewBox",`0 0 ${e} ${i}`),n}function Ze(e,i){let t=new XMLSerializer().serializeToString(e);return i&&(t=t.replace(/[\u0000-\u0008\v\f\u000E-\u001F\uD800-\uDFFF\uFFFE\uFFFF]/gu,"")),`data:image/svg+xml;charset=utf-8,${encodeURIComponent(t)}`}async function et(e,i="image/png",t=1){try{return await new Promise((n,o)=>{e.toBlob(r=>{r?n(r):o(new Error("Blob is null"))},i,t)})}catch(n){if(Oe)return tt(e.toDataURL(i,t));throw n}}function tt(e){let[i,t]=e.split(","),n=i.match(/data:(.+);/)?.[1]??void 0,o=window.atob(t),r=o.length,l=new Uint8Array(r);for(let s=0;s<r;s+=1)l[s]=o.charCodeAt(s);return new Blob([l],{type:n})}function me(e,i){return new Promise((t,n)=>{let o=new FileReader;o.onload=()=>t(o.result),o.onerror=()=>n(o.error),o.onabort=()=>n(new Error(`Failed read blob to ${i}`)),i==="dataUrl"?o.readAsDataURL(e):i==="arrayBuffer"&&o.readAsArrayBuffer(e)})}var it=e=>me(e,"dataUrl"),nt=e=>me(e,"arrayBuffer");function H(e,i){let t=U(i).createElement("img");return t.decoding="sync",t.loading="eager",t.src=e,t}function N(e,i){return new Promise(t=>{let{timeout:n,ownerDocument:o,onError:r,onWarn:l}=i??{},s=typeof e=="string"?H(e,U(o)):e,c=null,h=null;function a(){t(s),c&&clearTimeout(c),h?.()}if(n&&(c=setTimeout(a,n)),F(s)){let d=s.currentSrc||s.src;if(!d)return s.poster?N(s.poster,i).then(t):a();if(s.readyState>=2)return a();let g=a,m=u=>{l?.("Failed video load",d,u),r?.(u),a()};h=()=>{s.removeEventListener("loadeddata",g),s.removeEventListener("error",m)},s.addEventListener("loadeddata",g,{once:!0}),s.addEventListener("error",m,{once:!0})}else{let d=ge(s)?s.href.baseVal:s.currentSrc||s.src;if(!d)return a();let g=async()=>{if(L(s)&&"decode"in s)try{await s.decode()}catch(u){l?.("Failed to decode image, trying to render anyway",s.dataset.originalSrc||d,u)}a()},m=u=>{l?.("Failed image load",s.dataset.originalSrc||d,u),a()};if(L(s)&&s.complete)return g();h=()=>{s.removeEventListener("load",g),s.removeEventListener("error",m)},s.addEventListener("load",g,{once:!0}),s.addEventListener("error",m,{once:!0})}})}async function rt(e,i){x(e)&&(L(e)||F(e)?await N(e,i):await Promise.all(["img","video"].flatMap(t=>Array.from(e.querySelectorAll(t)).map(n=>N(n,i)))))}var fe=function(){let i=0,t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(i+=1,`u${t()}${i}`)}();function pe(e){return e?.split(",").map(i=>i.trim().replace(/"|'/g,"").toLowerCase()).filter(Boolean)}var ee=0;function st(e){let i=`${he}[#${ee}]`;return ee++,{time:t=>e&&console.time(`${i} ${t}`),timeEnd:t=>e&&console.timeEnd(`${i} ${t}`),warn:(...t)=>e&&Ke(...t)}}function ot(e){return{cache:e?"no-cache":"force-cache"}}async function j(e,i){return Pe(e)?e:lt(e,{...i,autoDestruct:!0})}async function lt(e,i){let{scale:t=1,workerUrl:n,workerNumber:o=1}=i||{},r=!!i?.debug,l=i?.features??!0,s=e.ownerDocument??(C?window.document:void 0),c=e.ownerDocument?.defaultView??(C?window:void 0),h=new Map,a={width:0,height:0,quality:1,type:"image/png",scale:t,backgroundColor:null,style:null,filter:null,maximumCanvasSize:0,timeout:3e4,progress:null,debug:r,fetch:{requestInit:ot(i?.fetch?.bypassingCache),placeholderImage:"data:image/png;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",bypassingCache:!1,...i?.fetch},fetchFn:null,font:{},drawImageInterval:100,workerUrl:null,workerNumber:o,onCloneNode:null,onEmbedNode:null,onCreateForeignObjectSvg:null,includeStyleProperties:null,autoDestruct:!1,...i,__CONTEXT__:!0,log:st(r),node:e,ownerDocument:s,ownerWindow:c,dpi:t===1?null:96*t,svgStyleElement:be(s),svgDefsElement:s?.createElementNS($,"defs"),svgStyles:new Map,defaultComputedStyles:new Map,workers:[...Array.from({length:_e&&n&&o?o:0})].map(()=>{try{let m=new Worker(n);return m.onmessage=async u=>{let{url:f,result:p}=u.data;p?h.get(f)?.resolve?.(p):h.get(f)?.reject?.(new Error(`Error receiving message from worker: ${f}`))},m.onmessageerror=u=>{let{url:f}=u.data;h.get(f)?.reject?.(new Error(`Error receiving message from worker: ${f}`))},m}catch(m){return a.log.warn("Failed to new Worker",m),null}}).filter(Boolean),fontFamilies:new Map,fontCssTexts:new Map,acceptOfImage:`${[Je(s)&&"image/webp","image/svg+xml","image/*","*/*"].filter(Boolean).join(",")};q=0.8`,requests:h,drawImageCount:0,tasks:[],features:l,isEnable:m=>m==="restoreScrollPosition"?typeof l=="boolean"?!1:l[m]??!1:typeof l=="boolean"?l:l[m]??!0};a.log.time("wait until load"),await rt(e,{timeout:a.timeout,onWarn:a.log.warn}),a.log.timeEnd("wait until load");let{width:d,height:g}=at(e,a);return a.width=d,a.height=g,a}function be(e){if(!e)return;let i=e.createElement("style"),t=i.ownerDocument.createTextNode(`
.______background-clip--text {
  background-clip: text;
  -webkit-background-clip: text;
}
`);return i.appendChild(t),i}function at(e,i){let{width:t,height:n}=i;if(y(e)&&(!t||!n)){let o=e.getBoundingClientRect();t=t||o.width||Number(e.getAttribute("width"))||0,n=n||o.height||Number(e.getAttribute("height"))||0}return{width:t,height:n}}async function ct(e,i){let{log:t,timeout:n,drawImageCount:o,drawImageInterval:r}=i;t.time("image to canvas");let l=await N(e,{timeout:n,onWarn:i.log.warn}),{canvas:s,context2d:c}=ht(e.ownerDocument,i),h=()=>{try{c?.drawImage(l,0,0,s.width,s.height)}catch(a){i.log.warn("Failed to drawImage",a)}};if(h(),i.isEnable("fixSvgXmlDecode"))for(let a=0;a<o;a++)await new Promise(d=>{setTimeout(()=>{h(),d()},a+r)});return i.drawImageCount=0,t.timeEnd("image to canvas"),s}function ht(e,i){let{width:t,height:n,scale:o,backgroundColor:r,maximumCanvasSize:l}=i,s=e.createElement("canvas");s.width=Math.floor(t*o),s.height=Math.floor(n*o),s.style.width=`${t}px`,s.style.height=`${n}px`,l&&(s.width>l||s.height>l)&&(s.width>l&&s.height>l?s.width>s.height?(s.height*=l/s.width,s.width=l):(s.width*=l/s.height,s.height=l):s.width>l?(s.height*=l/s.width,s.width=l):(s.width*=l/s.height,s.height=l));let c=s.getContext("2d");return c&&r&&(c.fillStyle=r,c.fillRect(0,0,s.width,s.height)),{canvas:s,context2d:c}}function Ee(e,i){if(e.ownerDocument)try{let r=e.toDataURL();if(r!=="data:,")return H(r,e.ownerDocument)}catch(r){i.log.warn("Failed to clone canvas",r)}let t=e.cloneNode(!1),n=e.getContext("2d"),o=t.getContext("2d");try{return n&&o&&o.putImageData(n.getImageData(0,0,e.width,e.height),0,0),t}catch(r){i.log.warn("Failed to clone canvas",r)}return t}function dt(e,i){try{if(e?.contentDocument?.body)return z(e.contentDocument.body,i)}catch(t){i.log.warn("Failed to clone iframe",t)}return e.cloneNode(!1)}function gt(e){let i=e.cloneNode(!1);return e.currentSrc&&e.currentSrc!==e.src&&(i.src=e.currentSrc,i.srcset=""),i.loading==="lazy"&&(i.loading="eager"),i}async function ut(e,i){if(e.ownerDocument&&!e.currentSrc&&e.poster)return H(e.poster,e.ownerDocument);let t=e.cloneNode(!1);t.crossOrigin="anonymous",e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc);let n=t.ownerDocument;if(n){let o=!0;if(await N(t,{onError:()=>o=!1,onWarn:i.log.warn}),!o)return e.poster?H(e.poster,e.ownerDocument):t;t.currentTime=e.currentTime,await new Promise(l=>{t.addEventListener("seeked",l,{once:!0})});let r=n.createElement("canvas");r.width=e.offsetWidth,r.height=e.offsetHeight;try{let l=r.getContext("2d");l&&l.drawImage(t,0,0,r.width,r.height)}catch(l){return i.log.warn("Failed to clone video",l),e.poster?H(e.poster,e.ownerDocument):t}return Ee(r,i)}return t}function mt(e,i){return We(e)?Ee(e,i):Ye(e)?dt(e,i):L(e)?gt(e):F(e)?ut(e,i):e.cloneNode(!1)}function ft(e){let i=e.sandbox;if(!i){let{ownerDocument:t}=e;try{t&&(i=t.createElement("iframe"),i.id=`__SANDBOX__-${fe()}`,i.width="0",i.height="0",i.style.visibility="hidden",i.style.position="fixed",t.body.appendChild(i),i.contentWindow?.document.write('<!DOCTYPE html><meta charset="UTF-8"><title></title><body>'),e.sandbox=i)}catch(n){e.log.warn("Failed to getSandBox",n)}}return i}var pt=["width","height","-webkit-text-fill-color"],bt=["stroke","fill"];function we(e,i,t){let{defaultComputedStyles:n}=t,o=e.nodeName.toLowerCase(),r=I(e)&&o!=="svg",l=r?bt.map(f=>[f,e.getAttribute(f)]).filter(([,f])=>f!==null):[],s=[r&&"svg",o,l.map((f,p)=>`${f}=${p}`).join(","),i].filter(Boolean).join(":");if(n.has(s))return n.get(s);let h=ft(t)?.contentWindow;if(!h)return new Map;let a=h?.document,d,g;r?(d=a.createElementNS($,"svg"),g=d.ownerDocument.createElementNS(d.namespaceURI,o),l.forEach(([f,p])=>{g.setAttributeNS(null,f,p)}),d.appendChild(g)):d=g=a.createElement(o),g.textContent=" ",a.body.appendChild(d);let m=h.getComputedStyle(g,i),u=new Map;for(let f=m.length,p=0;p<f;p++){let b=m.item(p);pt.includes(b)||u.set(b,m.getPropertyValue(b))}return a.body.removeChild(d),n.set(s,u),u}function ve(e,i,t){let n=new Map,o=[],r=new Map;if(t)for(let s of t)l(s);else for(let s=e.length,c=0;c<s;c++){let h=e.item(c);l(h)}for(let s=o.length,c=0;c<s;c++)r.get(o[c])?.forEach((h,a)=>n.set(a,h));function l(s){let c=e.getPropertyValue(s),h=e.getPropertyPriority(s),a=s.lastIndexOf("-"),d=a>-1?s.substring(0,a):void 0;if(d){let g=r.get(d);g||(g=new Map,r.set(d,g)),g.set(s,[c,h])}i.get(s)===c&&!h||(d?o.push(d):n.set(s,[c,h]))}return n}function Et(e,i,t,n){let{ownerWindow:o,includeStyleProperties:r,currentParentNodeStyle:l}=n,s=i.style,c=o.getComputedStyle(e),h=we(e,null,n);l?.forEach((d,g)=>{h.delete(g)});let a=ve(c,h,r);a.delete("transition-property"),a.delete("all"),a.delete("d"),a.delete("content"),t&&(a.delete("margin-top"),a.delete("margin-right"),a.delete("margin-bottom"),a.delete("margin-left"),a.delete("margin-block-start"),a.delete("margin-block-end"),a.delete("margin-inline-start"),a.delete("margin-inline-end"),a.set("box-sizing",["border-box",""])),a.get("background-clip")?.[0]==="text"&&i.classList.add("______background-clip--text"),de&&(a.has("font-kerning")||a.set("font-kerning",["normal",""]),(a.get("overflow-x")?.[0]==="hidden"||a.get("overflow-y")?.[0]==="hidden")&&a.get("text-overflow")?.[0]==="ellipsis"&&e.scrollWidth===e.clientWidth&&a.set("text-overflow",["clip",""]));for(let d=s.length,g=0;g<d;g++)s.removeProperty(s.item(g));return a.forEach(([d,g],m)=>{s.setProperty(m,d,g)}),a}function wt(e,i){(Ge(e)||Ve(e)||ze(e))&&i.setAttribute("value",e.value)}var vt=[":before",":after"],yt=[":-webkit-scrollbar",":-webkit-scrollbar-button",":-webkit-scrollbar-thumb",":-webkit-scrollbar-track",":-webkit-scrollbar-track-piece",":-webkit-scrollbar-corner",":-webkit-resizer"];function St(e,i,t,n,o){let{ownerWindow:r,svgStyleElement:l,svgStyles:s,currentNodeStyle:c}=n;if(!l||!r)return;function h(a){let d=r.getComputedStyle(e,a),g=d.getPropertyValue("content");if(!g||g==="none")return;o?.(g),g=g.replace(/(')|(")|(counter\(.+\))/g,"");let m=[fe()],u=we(e,a,n);c?.forEach((E,v)=>{u.delete(v)});let f=ve(d,u,n.includeStyleProperties);f.delete("content"),f.delete("-webkit-locale"),f.get("background-clip")?.[0]==="text"&&i.classList.add("______background-clip--text");let p=[`content: '${g}';`];if(f.forEach(([E,v],A)=>{p.push(`${A}: ${E}${v?" !important":""};`)}),p.length===1)return;try{i.className=[i.className,...m].join(" ")}catch(E){n.log.warn("Failed to copyPseudoClass",E);return}let b=p.join(`
  `),w=s.get(b);w||(w=[],s.set(b,w)),w.push(`.${m[0]}:${a}`)}vt.forEach(h),t&&yt.forEach(h)}var te=new Set(["symbol"]);async function ie(e,i,t,n,o){if(y(t)&&(qe(t)||je(t))||n.filter&&!n.filter(t))return;te.has(i.nodeName)||te.has(t.nodeName)?n.currentParentNodeStyle=void 0:n.currentParentNodeStyle=n.currentNodeStyle;let r=await z(t,n,!1,o);n.isEnable("restoreScrollPosition")&&At(e,r),i.appendChild(r)}async function ne(e,i,t,n){let o=(y(e)?e.shadowRoot?.firstChild:void 0)??e.firstChild;for(let r=o;r;r=r.nextSibling)if(!$e(r))if(y(r)&&Xe(r)&&typeof r.assignedNodes=="function"){let l=r.assignedNodes();for(let s=0;s<l.length;s++)await ie(e,i,l[s],t,n)}else await ie(e,i,r,t,n)}function At(e,i){if(!x(e)||!x(i))return;let{scrollTop:t,scrollLeft:n}=e;if(!t&&!n)return;let{transform:o}=i.style,r=new DOMMatrix(o),{a:l,b:s,c,d:h}=r;r.a=1,r.b=0,r.c=0,r.d=1,r.translateSelf(-n,-t),r.a=l,r.b=s,r.c=c,r.d=h,i.style.transform=r.toString()}function Tt(e,i){let{backgroundColor:t,width:n,height:o,style:r}=i,l=e.style;if(t&&l.setProperty("background-color",t,"important"),n&&l.setProperty("width",`${n}px`,"important"),o&&l.setProperty("height",`${o}px`,"important"),r)for(let s in r)l[s]=r[s]}var Ct=/^[\w-:]+$/;async function z(e,i,t=!1,n){let{ownerDocument:o,ownerWindow:r,fontFamilies:l}=i;if(o&&Be(e))return n&&/\S/.test(e.data)&&n(e.data),o.createTextNode(e.data);if(o&&r&&y(e)&&(x(e)||I(e))){let c=await mt(e,i);if(i.isEnable("removeAbnormalAttributes")){let u=c.getAttributeNames();for(let f=u.length,p=0;p<f;p++){let b=u[p];Ct.test(b)||c.removeAttribute(b)}}let h=i.currentNodeStyle=Et(e,c,t,i);t&&Tt(c,i);let a=!1;if(i.isEnable("copyScrollbar")){let u=[h.get("overflow-x")?.[0],h.get("overflow-y")?.[0]];a=u.includes("scroll")||(u.includes("auto")||u.includes("overlay"))&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}let d=h.get("text-transform")?.[0],g=pe(h.get("font-family")?.[0]),m=g?u=>{d==="uppercase"?u=u.toUpperCase():d==="lowercase"?u=u.toLowerCase():d==="capitalize"&&(u=u[0].toUpperCase()+u.substring(1)),g.forEach(f=>{let p=l.get(f);p||l.set(f,p=new Set),u.split("").forEach(b=>p.add(b))})}:void 0;return St(e,c,a,i,m),wt(e,c),F(e)||await ne(e,c,i,m),c}let s=e.cloneNode(!1);return await ne(e,s,i),s}function Ht(e){if(e.ownerDocument=void 0,e.ownerWindow=void 0,e.svgStyleElement=void 0,e.svgDefsElement=void 0,e.svgStyles.clear(),e.defaultComputedStyles.clear(),e.sandbox){try{e.sandbox.remove()}catch(i){e.log.warn("Failed to destroyContext",i)}e.sandbox=void 0}e.workers=[],e.fontFamilies.clear(),e.fontCssTexts.clear(),e.requests.clear(),e.tasks=[]}function Lt(e){let{url:i,timeout:t,responseType:n,...o}=e,r=new AbortController,l=t?setTimeout(()=>r.abort(),t):void 0;return fetch(i,{signal:r.signal,...o}).then(s=>{if(!s.ok)throw new Error("Failed fetch, not 2xx response",{cause:s});switch(n){case"arrayBuffer":return s.arrayBuffer();case"dataUrl":return s.blob().then(it);case"text":default:return s.text()}}).finally(()=>clearTimeout(l))}function D(e,i){let{url:t,requestType:n="text",responseType:o="text",imageDom:r}=i,l=t,{timeout:s,acceptOfImage:c,requests:h,fetchFn:a,fetch:{requestInit:d,bypassingCache:g,placeholderImage:m},font:u,workers:f,fontFamilies:p}=e;n==="image"&&(k||q)&&e.drawImageCount++;let b=h.get(t);if(!b){g&&g instanceof RegExp&&g.test(l)&&(l+=(/\?/.test(l)?"&":"?")+new Date().getTime());let w=n.startsWith("font")&&u&&u.minify,E=new Set;w&&n.split(";")[1].split(",").forEach(O=>{p.has(O)&&p.get(O).forEach(J=>E.add(J))});let v=w&&E.size,A={url:l,timeout:s,responseType:v?"arrayBuffer":o,headers:n==="image"?{accept:c}:void 0,...d};b={type:n,resolve:void 0,reject:void 0,response:null},b.response=(async()=>{if(a&&n==="image"){let S=await a(t);if(S)return S}return!k&&t.startsWith("http")&&f.length?new Promise((S,O)=>{f[h.size&f.length-1].postMessage({rawUrl:t,...A}),b.resolve=S,b.reject=O}):Lt(A)})().catch(S=>{if(h.delete(t),n==="image"&&m)return e.log.warn("Failed to fetch image base64, trying to use placeholder image",l),typeof m=="string"?m:m(r);throw S}),h.set(t,b)}return b.response}async function ye(e,i,t,n){if(!Se(e))return e;for(let[o,r]of xt(e,i))try{let l=await D(t,{url:r,requestType:n?"image":"text",responseType:"dataUrl"});e=e.replace(Nt(o),`$1${l}$3`)}catch(l){t.log.warn("Failed to fetch css data url",o,l)}return e}function Se(e){return/url\((['"]?)([^'"]+?)\1\)/.test(e)}var Ae=/url\((['"]?)([^'"]+?)\1\)/g;function xt(e,i){let t=[];return e.replace(Ae,(n,o,r)=>(t.push([r,ue(r,i)]),n)),t.filter(([n])=>!G(n))}function Nt(e){let i=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${i})(['"]?\\))`,"g")}var Dt=["background-image","border-image-source","-webkit-border-image","-webkit-mask-image","list-style-image"];function It(e,i){return Dt.map(t=>{let n=e.getPropertyValue(t);return!n||n==="none"?null:((k||q)&&i.drawImageCount++,ye(n,null,i,!0).then(o=>{!o||n===o||e.setProperty(t,o,e.getPropertyPriority(t))}))}).filter(Boolean)}function Mt(e,i){if(L(e)){let t=e.currentSrc||e.src;if(!G(t))return[D(i,{url:t,imageDom:e,requestType:"image",responseType:"dataUrl"}).then(n=>{n&&(e.srcset="",e.dataset.originalSrc=t,e.src=n||"")})];(k||q)&&i.drawImageCount++}else if(I(e)&&!G(e.href.baseVal)){let t=e.href.baseVal;return[D(i,{url:t,imageDom:e,requestType:"image",responseType:"dataUrl"}).then(n=>{n&&(e.dataset.originalSrc=t,e.href.baseVal=n||"")})]}return[]}function Rt(e,i){let{ownerDocument:t,svgDefsElement:n}=i,o=e.getAttribute("href")??e.getAttribute("xlink:href");if(!o)return[];let[r,l]=o.split("#");if(l){let s=`#${l}`,c=t?.querySelector(`svg ${s}`);if(r&&e.setAttribute("href",s),n?.querySelector(s))return[];if(c)return n?.appendChild(c.cloneNode(!0)),[];if(r)return[D(i,{url:r,responseType:"text"}).then(h=>{n?.insertAdjacentHTML("beforeend",h)})]}return[]}function Te(e,i){let{tasks:t}=i;y(e)&&((L(e)||ge(e))&&t.push(...Mt(e,i)),Ue(e)&&t.push(...Rt(e,i))),x(e)&&t.push(...It(e.style,i)),e.childNodes.forEach(n=>{Te(n,i)})}async function _t(e,i){let{ownerDocument:t,svgStyleElement:n,fontFamilies:o,fontCssTexts:r,tasks:l,font:s}=i;if(!(!t||!n||!o.size))if(s&&s.cssText){let c=se(s.cssText,i);n.appendChild(t.createTextNode(`${c}
`))}else{let c=Array.from(t.styleSheets).filter(a=>{try{return"cssRules"in a&&!!a.cssRules.length}catch(d){return i.log.warn(`Error while reading CSS rules from ${a.href}`,d),!1}});await Promise.all(c.flatMap(a=>Array.from(a.cssRules).map(async(d,g)=>{if(Fe(d)){let m=g+1,u=d.href,f="";try{f=await D(i,{url:u,requestType:"text",responseType:"text"})}catch(b){i.log.warn(`Error fetch remote css import from ${u}`,b)}let p=f.replace(Ae,(b,w,E)=>b.replace(E,ue(E,u)));for(let b of Pt(p))try{a.insertRule(b,b.startsWith("@import")?m+=1:a.cssRules.length)}catch(w){i.log.warn("Error inserting rule from remote css import",{rule:b,error:w})}}}))),c.flatMap(a=>Array.from(a.cssRules)).filter(a=>ke(a)&&Se(a.style.getPropertyValue("src"))&&pe(a.style.getPropertyValue("font-family"))?.some(d=>o.has(d))).forEach(a=>{let d=a,g=r.get(d.cssText);g?n.appendChild(t.createTextNode(`${g}
`)):l.push(ye(d.cssText,d.parentStyleSheet?d.parentStyleSheet.href:null,i).then(m=>{m=se(m,i),r.set(d.cssText,m),n.appendChild(t.createTextNode(`${m}
`))}))})}}var Ot=/(\/\*[\s\S]*?\*\/)/g,re=/((@.*?keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi;function Pt(e){if(e==null)return[];let i=[],t=e.replace(Ot,"");for(;;){let r=re.exec(t);if(!r)break;i.push(r[0])}t=t.replace(re,"");let n=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let r=n.exec(t);if(r)o.lastIndex=n.lastIndex;else if(r=o.exec(t),r)n.lastIndex=o.lastIndex;else break;i.push(r[0])}return i}var kt=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Ft=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function se(e,i){let{font:t}=i,n=t?t?.preferredFormat:void 0;return n?e.replace(Ft,o=>{for(;;){let[r,,l]=kt.exec(o)||[];if(!l)return"";if(l===n)return`src: ${r};`}}):e}async function Ut(e,i){let t=await j(e,i);if(y(t.node)&&I(t.node))return t.node;let{ownerDocument:n,log:o,tasks:r,svgStyleElement:l,svgDefsElement:s,svgStyles:c,font:h,progress:a,autoDestruct:d,onCloneNode:g,onEmbedNode:m,onCreateForeignObjectSvg:u}=t;o.time("clone node");let f=await z(t.node,t,!0);if(l&&n){let v="";c.forEach((A,S)=>{v+=`${A.join(`,
`)} {
  ${S}
}
`}),l.appendChild(n.createTextNode(v))}o.timeEnd("clone node"),await g?.(f),h!==!1&&y(f)&&(o.time("embed web font"),await _t(f,t),o.timeEnd("embed web font")),o.time("embed node"),Te(f,t);let p=r.length,b=0,w=async()=>{for(;;){let v=r.pop();if(!v)break;try{await v}catch(A){t.log.warn("Failed to run task",A)}a?.(++b,p)}};a?.(b,p),await Promise.all([...Array.from({length:4})].map(w)),o.timeEnd("embed node"),await m?.(f);let E=$t(f,t);return s&&E.insertBefore(s,E.children[0]),l&&E.insertBefore(l,E.children[0]),d&&Ht(t),await u?.(E),E}function $t(e,i){let{width:t,height:n}=i,o=Qe(t,n,e.ownerDocument),r=o.ownerDocument.createElementNS(o.namespaceURI,"foreignObject");return r.setAttributeNS(null,"x","0%"),r.setAttributeNS(null,"y","0%"),r.setAttributeNS(null,"width","100%"),r.setAttributeNS(null,"height","100%"),r.append(e),o.appendChild(r),o}async function Bt(e,i){let t=await j(e,i),n=await Ut(t),o=Ze(n,t.isEnable("removeControlCharacter"));t.autoDestruct||(t.svgStyleElement=be(t.ownerDocument),t.svgDefsElement=t.ownerDocument?.createElementNS($,"defs"),t.svgStyles.clear());let r=H(o,n.ownerDocument);return await ct(r,t)}async function Ce(e,i){let t=await j(e,i),{log:n,type:o,quality:r,dpi:l}=t,s=await Bt(t);n.time("canvas to blob");let c=await et(s,o,r);if(["image/png","image/jpeg"].includes(o)&&l){let h=await nt(c.slice(0,33)),a=new Uint8Array(h);return o==="image/png"?a=Re(a,l):o==="image/jpeg"&&(a=Ne(a,l)),n.timeEnd("canvas to blob"),new Blob([a,c.slice(33)],{type:o})}return n.timeEnd("canvas to blob"),c}var M={METADATA:"data-replit-metadata",COMPONENT_NAME:"data-component-name"};function He(e){if(e.startsWith("http://localhost:"))return!0;try{return new URL(e).hostname.endsWith(T.ALLOWED_DOMAIN)}catch{return!1}}function Y(e){if(!e)return null;let i=document.elementFromPoint(e.clientX,e.clientY);return i instanceof HTMLElement?i:null}function Jt(e,i=300){if(!e)return"";let t=String(e);return t.length<=i?t:t.slice(0,i)+"..."}function X(e){if(e)return{tagName:e.tagName.toLowerCase(),className:e.className.toString?e.className.toString():String(e.className),textContent:e.textContent??"",id:e.id}}function B(e){return e.getAttribute(M.COMPONENT_NAME)??e.tagName.toLowerCase()}function K(e){let i=window.getComputedStyle(e),t=e.parentElement,n=e.nextElementSibling,o=t?.parentElement??null,r={backgroundColor:i.backgroundColor,color:i.color,display:i.display,position:i.position,width:i.width,height:i.height,fontSize:i.fontSize,fontFamily:i.fontFamily,fontWeight:i.fontWeight,margin:i.margin,padding:i.padding,textAlign:i.textAlign};return{elementPath:e.getAttribute(M.METADATA)??"",elementName:B(e),textContent:e.textContent??"",originalTextContent:e.getAttribute("data-original-text")?decodeURIComponent(e.getAttribute("data-original-text")??""):void 0,srcAttribute:e.getAttribute("src")??"",hasChildElements:e.childElementCount>0,id:e.id,className:e.className.toString?e.className.toString():String(e.className),computedStyles:r,textAlign:i.textAlign,relatedElements:{parent:X(t),nextSibling:X(n),grandParent:X(o)}}}async function Le(e){try{let t=window.getComputedStyle(e).backgroundColor;return Wt(t)&&(t=window.getComputedStyle(document.documentElement).backgroundColor),await Ce(e,{type:"image/png",backgroundColor:t,fetch:{requestInit:{mode:"no-cors"}}})}catch(i){console.error("[replit-cartographer] Failed to take screenshot:",i);return}}function Wt(e){return e==="transparent"||e==="rgba(0, 0, 0, 0)"||e.endsWith(", 0)")||e.endsWith(",0)")}function R(e){let i=e.getAttribute(M.METADATA);if(!i)return[];let t=`[${M.METADATA}="${i}"]`;return Array.from(document.querySelectorAll(t)).filter(o=>o instanceof HTMLElement).filter(o=>o!==e)}var _=class{selectedElement=null;selectedSiblingElements=[];isActive=!1;lastHighlightedElement=null;enableEditing=!1;shadowHost=null;shadowRoot=null;hoverHighlighter=null;hoverLabel=null;selectedHighlighter=null;selectedLabel=null;hoverSiblingHighlighters=[];selectedSiblingHighlighters=[];mutationObserver=null;constructor(){this.setupMessageListener(),this.notifyScriptLoaded()}initializeHighlighter(){this.shadowHost=document.createElement("div"),this.shadowHost.style.all="initial",this.shadowRoot=this.shadowHost.attachShadow({mode:"open"}),document.body.appendChild(this.shadowHost);let i=document.createElement("style");i.textContent=Z,this.shadowRoot.appendChild(i);let t=document.createElement("style");t.textContent=Q,document.head.appendChild(t),this.hoverHighlighter=document.createElement("div"),this.hoverLabel=document.createElement("div"),this.hoverHighlighter.className="beacon-highlighter beacon-hover-highlighter",this.hoverLabel.className="beacon-label beacon-hover-label",this.selectedHighlighter=document.createElement("div"),this.selectedLabel=document.createElement("div"),this.selectedHighlighter.className="beacon-highlighter beacon-selected-highlighter",this.selectedLabel.className="beacon-label beacon-selected-label",this.shadowRoot.appendChild(this.selectedHighlighter),this.shadowRoot.appendChild(this.selectedLabel),this.shadowRoot.appendChild(this.hoverHighlighter),this.shadowRoot.appendChild(this.hoverLabel)}setupMessageListener(){window.addEventListener("message",this.handleMessage.bind(this))}notifyScriptLoaded(){this.postMessageToParent({type:"SELECTOR_SCRIPT_LOADED",timestamp:Date.now(),version:P})}postMessageToParent(i){window.parent&&window.parent.postMessage(i,"*")}handleMouseMove=i=>{if(this.isActive&&this.hoverHighlighter){let t=Y(i);if(!t||t===this.hoverHighlighter||t===this.selectedHighlighter||t===this.shadowHost||this.selectedSiblingHighlighters.includes(t)||this.hoverSiblingHighlighters.includes(t)){this.hideHighlight(this.hoverHighlighter,this.hoverLabel),this.lastHighlightedElement=null,this.clearHoverSiblingHighlighters();return}if(t===this.selectedElement){this.hideHighlight(this.hoverHighlighter,this.hoverLabel),this.lastHighlightedElement=null,this.clearHoverSiblingHighlighters();return}this.lastHighlightedElement&&this.lastHighlightedElement!==t&&this.lastHighlightedElement!==this.selectedElement&&this.lastHighlightedElement.removeAttribute("contenteditable"),this.lastHighlightedElement=t,this.updateHighlighterPosition(t,this.hoverHighlighter,this.hoverLabel)}};handleMouseLeave=()=>{this.isActive&&(this.hoverHighlighter&&(this.hoverHighlighter.style.opacity="0"),this.hoverLabel&&(this.hoverLabel.style.opacity="0"),this.hoverSiblingHighlighters.length>0&&this.clearHoverSiblingHighlighters(),this.lastHighlightedElement&&this.lastHighlightedElement!==this.selectedElement&&this.lastHighlightedElement.removeAttribute("contenteditable"))};calculateLabelPosition(i,t){return t<28?{top:`${t+window.scrollY}px`,left:`${i.left+window.scrollX}px`,transform:"none",marginTop:"2px"}:{top:`${t+window.scrollY}px`,left:`${i.left+window.scrollX}px`,transform:"translateY(-100%)",marginTop:"-4px"}}updateHighlighterPosition(i,t,n){if(!t||!n)return;let o=R(i);this.enableEditing&&o.length<=1&&i===this.selectedElement&&i.childElementCount===0&&i.tagName.toLowerCase()!=="img"&&i.setAttribute("contenteditable","plaintext-only");let r=i.getBoundingClientRect(),l=window.innerHeight,s=Math.max(0,r.top),c=Math.min(l,r.bottom),h=Math.max(0,c-s);Object.assign(t.style,{opacity:h>0?"1":"0",top:`${s}px`,left:`${r.left}px`,width:`${r.width}px`,height:`${h}px`}),n.textContent=B(i);let a=this.calculateLabelPosition(r,s);Object.assign(n.style,{...a,opacity:h>0?"1":"0"}),t===this.selectedHighlighter?this.highlightSelectedSiblings(i):this.highlightHoverSiblings(i)}hideHighlight(i,t){i&&(i.style.opacity="0"),t&&(t.style.opacity="0");let n=i===this.hoverHighlighter,o=i===this.selectedHighlighter;n&&this.clearHoverSiblingHighlighters(),o&&this.clearSelectedSiblingHighlighters()}handleClick=async i=>{if(!this.isActive)return;i.preventDefault(),i.stopPropagation();let t=Y(i);if((!t||t===this.hoverHighlighter||t===this.selectedHighlighter||t===this.shadowHost)&&(t=this.lastHighlightedElement),!t||t===this.selectedElement)return;this.unselectCurrentElement(),this.clearSelectedSiblingHighlighters(),this.selectedElement=t;let n=R(t),o=n.length>0;o&&this.highlightSelectedSiblings(t),t.hasAttribute("data-original-text")||t.setAttribute("data-original-text",encodeURIComponent(t.textContent??"")),!t.hasAttribute("data-original-style")&&t.hasAttribute("style")&&t.setAttribute("data-original-style",encodeURIComponent(t.getAttribute("style")??"")),!t.hasAttribute("data-original-src")&&t.hasAttribute("src")&&t.setAttribute("data-original-src",encodeURIComponent(t.getAttribute("src")??"")),!o&&this.enableEditing&&t.childElementCount===0&&t.tagName.toLowerCase()!=="img"&&(this.selectedElement.setAttribute("contenteditable","plaintext-only"),this.selectedElement.focus()),this.selectedHighlighter&&this.selectedLabel&&(this.selectedHighlighter.style.outlineStyle="solid",this.selectedHighlighter.style.opacity="1",this.selectedHighlighter.style.pointerEvents="none",this.selectedLabel.style.opacity="1",this.selectedLabel.textContent=B(t)),this.hoverHighlighter&&(this.hoverHighlighter.style.opacity="0",this.hoverHighlighter.style.pointerEvents="none"),this.hoverLabel&&(this.hoverLabel.style.opacity="0"),this.clearHoverSiblingHighlighters(),this.updateHighlighterPosition(t,this.selectedHighlighter,this.selectedLabel);let r=K(t),l;try{l=await Le(t)}catch(s){console.error("[replit-cartographer] Error capturing element screenshot:",s)}this.observeSelectedElement(),this.postMessageToParent({type:"ELEMENT_SELECTED",payload:{...r,screenshotBlob:l??void 0,siblingCount:o?n.length:0},timestamp:Date.now()})};restoreElements(){document.querySelectorAll('[data-replit-dirty="true"]').forEach(t=>{if(t.hasAttribute("data-original-text")&&t.textContent!==decodeURIComponent(t.getAttribute("data-original-text")||"")){let n=decodeURIComponent(t.getAttribute("data-original-text")||"");t.textContent=n,t.removeAttribute("data-original-text")}if(t.hasAttribute("data-original-style")){let n=decodeURIComponent(t.getAttribute("data-original-style")||"");t.setAttribute("style",n),t.removeAttribute("data-original-style")}else t.removeAttribute("style");if(t.hasAttribute("data-original-src")&&t.getAttribute("src")!==decodeURIComponent(t.getAttribute("data-original-src")||"")){let n=decodeURIComponent(t.getAttribute("data-original-src")||"");t.setAttribute("src",n),t.removeAttribute("data-original-src")}t.removeAttribute("data-replit-dirty")})}unselectCurrentElement(){if(this.restoreElements(),this.selectedElement){if(this.selectedElement.removeAttribute("contenteditable"),this.selectedElement.hasAttribute("data-original-style")){let i=decodeURIComponent(this.selectedElement.getAttribute("data-original-style")||"");this.selectedElement.setAttribute("style",i),this.selectedElement.removeAttribute("data-original-style")}if(this.selectedElement.hasAttribute("data-original-src")&&this.selectedElement.getAttribute("src")!==decodeURIComponent(this.selectedElement.getAttribute("data-original-src")||"")){let i=decodeURIComponent(this.selectedElement.getAttribute("data-original-src")||"");this.selectedElement.setAttribute("src",i),this.selectedElement.removeAttribute("data-original-src")}this.selectedElement=null}this.clearSelectedSiblingHighlighters(),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null)}handleMessage=i=>{if(!He(i.origin))return;let t=i.data;if(!(!t||typeof t!="object"))switch(t.type){case"TOGGLE_REPLIT_VISUAL_EDITOR":{this.handleVisualEditorToggle(t);break}case"CLEAR_SELECTION":{this.unselectCurrentElement(),this.hideHighlight(this.selectedHighlighter,this.selectedLabel);break}case"UPDATE_SELECTED_ELEMENT":{if(!this.selectedElement)return;let{attributes:n}=t;[this.selectedElement,...this.selectedSiblingElements].forEach(r=>{n.style!==void 0&&(r.setAttribute("style",n.style),r.setAttribute("data-replit-dirty","true")),n.textContent!==void 0&&(r.textContent=n.textContent,r.setAttribute("data-replit-dirty","true")),n.className!==void 0&&(r.className=n.className,r.setAttribute("data-replit-dirty","true")),n.src!==void 0&&(r.setAttribute("src",n.src),r.setAttribute("data-replit-dirty","true"))}),this.updateHighlighterPosition(this.selectedElement,this.selectedHighlighter,this.selectedLabel),this.selectedSiblingElements.length>0&&(this.clearHighlighters(this.selectedSiblingHighlighters),this.selectedSiblingHighlighters=[],this.selectedSiblingHighlighters=this.highlightElements(this.selectedSiblingElements));break}case"CLEAR_ELEMENT_DIRTY":{this.selectedElement&&this.selectedElement.removeAttribute("data-replit-dirty");break}}};handleVisualEditorToggle(i){if(i.type!=="TOGGLE_REPLIT_VISUAL_EDITOR")return;let t=!!i.enabled;this.enableEditing=!!i.enableEditing,t?this.postMessageToParent({type:"REPLIT_VISUAL_EDITOR_ENABLED",timestamp:Date.now()}):this.postMessageToParent({type:"REPLIT_VISUAL_EDITOR_DISABLED",timestamp:Date.now()}),this.isActive!==t&&(this.isActive=t,this.toggleEventListeners(t))}observeSelectedElement(){this.selectedElement&&(this.mutationObserver&&this.mutationObserver.disconnect(),this.mutationObserver=new MutationObserver(i=>{if(i.some(n=>n.type==="characterData")&&this.selectedElement){this.selectedElement.setAttribute("data-replit-dirty","true");let n=K(this.selectedElement);this.postMessageToParent({type:"ELEMENT_TEXT_CHANGED",payload:n,timestamp:Date.now()}),this.updateHighlighterPosition(this.selectedElement,this.selectedHighlighter,this.selectedLabel)}}),this.mutationObserver.observe(this.selectedElement,{characterData:!0,childList:!1,attributes:!1,subtree:!0}))}recalculateSelectedElement=()=>{this.isActive&&(this.selectedElement&&this.updateHighlighterPosition(this.selectedElement,this.selectedHighlighter,this.selectedLabel),this.lastHighlightedElement&&this.updateHighlighterPosition(this.lastHighlightedElement,this.hoverHighlighter,this.hoverLabel),this.selectedSiblingElements.length>0&&(this.clearHighlighters(this.selectedSiblingHighlighters),this.selectedSiblingHighlighters=[],this.selectedSiblingHighlighters=this.highlightElements(this.selectedSiblingElements)))};handleKeyDown=i=>{this.isActive&&(i.key==="Escape"||i.key==="Esc")&&this.handleVisualEditorToggle({type:"TOGGLE_REPLIT_VISUAL_EDITOR",enabled:!1,timestamp:Date.now()})};toggleEventListeners(i){i?(this.initializeHighlighter(),this.enableDisabledElements(),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseleave",this.handleMouseLeave),document.addEventListener("click",this.handleClick,!0),document.addEventListener("keydown",this.handleKeyDown),window.addEventListener("resize",this.recalculateSelectedElement),window.addEventListener("scroll",this.recalculateSelectedElement,!0)):(this.restoreDisabledElements(),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("click",this.handleClick,!0),document.removeEventListener("mouseleave",this.handleMouseLeave),document.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("resize",this.recalculateSelectedElement),window.removeEventListener("scroll",this.recalculateSelectedElement,!0),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null),this.selectedElement&&(this.selectedElement.removeAttribute("contenteditable"),this.selectedElement.removeAttribute("data-original-text"),document.querySelectorAll('[contenteditable="plaintext-only"]').forEach(t=>{t.removeAttribute("contenteditable")})),this.clearSelectedSiblingHighlighters(),this.clearHoverSiblingHighlighters(),this.hoverHighlighter?.remove(),this.hoverLabel?.remove(),this.selectedHighlighter?.remove(),this.selectedLabel?.remove(),this.shadowHost?.remove(),this.hoverHighlighter=null,this.hoverLabel=null,this.selectedHighlighter=null,this.selectedLabel=null,this.shadowHost=null,this.shadowRoot=null,this.selectedElement=null)}clearHighlighters(i){return i.forEach(t=>{t.remove()}),[]}clearHoverSiblingHighlighters(){this.hoverSiblingHighlighters=this.clearHighlighters(this.hoverSiblingHighlighters)}clearSelectedSiblingHighlighters(){this.selectedSiblingElements.forEach(i=>{i.removeAttribute("contenteditable")}),this.selectedSiblingElements=[],this.selectedSiblingHighlighters=this.clearHighlighters(this.selectedSiblingHighlighters)}highlightElements(i){if(!this.shadowRoot||i.length===0)return[];let t=[];return i.forEach(n=>{let o=document.createElement("div");o.className="beacon-highlighter beacon-sibling-highlighter",this.shadowRoot?.appendChild(o),t.push(o);let r=n.getBoundingClientRect(),l=window.innerHeight,s=Math.max(0,r.top),c=Math.min(l,r.bottom),h=Math.max(0,c-s);Object.assign(o.style,{opacity:h>0?"1":"0",top:`${s}px`,left:`${r.left}px`,width:`${r.width}px`,height:`${h}px`})}),t}highlightHoverSiblings(i){this.clearHoverSiblingHighlighters();let t=R(i);this.hoverSiblingHighlighters=this.highlightElements(t)}highlightSelectedSiblings(i){this.clearSelectedSiblingHighlighters(),this.selectedSiblingElements=R(i),this.selectedSiblingHighlighters=this.highlightElements(this.selectedSiblingElements)}enableDisabledElements(){document.querySelectorAll("button[disabled], input[disabled]").forEach(i=>{i.removeAttribute("disabled"),i.setAttribute("data-replit-disabled","")})}restoreDisabledElements(){document.querySelectorAll("[data-replit-disabled]").forEach(i=>{i.removeAttribute("data-replit-disabled"),i.setAttribute("disabled","")})}};if(typeof window<"u")try{window.REPLIT_BEACON_VERSION||(window.REPLIT_BEACON_VERSION=P,new _)}catch(e){console.error("[replit-beacon] Failed to initialize:",e)}})();
</script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx?v=nAsb7YAqeoGdabY62TdcL"></script>
    <!-- This is a replit script which adds a banner on the top of the page when opened in development mode outside the replit environment -->
    <script type="text/javascript" src="https://replit.com/public/js/replit-dev-banner.js"></script>
  </body>
</html>{"message":"Failed to fetch system settings"}root@vlxsam02:/opt/samureye#
root@vlxsam02:/opt/samureye# curl -X POST http://localhost:5000/api/admin/login \
  -H "Content-Type: application/json" \
  -d '{"email": "admin@samureye.com.br", "password": "SamurEye2024!"}'
{"success":true,"message":"Login realizado com sucesso"}root@vlxsam02:/opt/samureye#
root@vlxsam02:/opt/samureye#
root@vlxsam02:/opt/samureye# curl http://localhost:5000/public-objects/test
{"error":"Internal server error"}root@vlxsam02:/opt/samureye#
root@vlxsam02:/opt/samureye#
root@vlxsam02:/opt/samureye# wscat -c ws://localhost:5000/ws
Connected (press CTRL+C to quit)
>
> root@vlxsam02:/opt/samureye# journalctl -u samureye-app -f
Aug 26 16:55:01 vlxsam02 samureye-app[79712]:     code: 'ECONNREFUSED',
Aug 26 16:55:01 vlxsam02 samureye-app[79712]:     syscall: 'connect',
Aug 26 16:55:01 vlxsam02 samureye-app[79712]:     address: '172.24.1.153',
Aug 26 16:55:01 vlxsam02 samureye-app[79712]:     port: 443
Aug 26 16:55:01 vlxsam02 samureye-app[79712]:   },
Aug 26 16:55:01 vlxsam02 samureye-app[79712]:   [Symbol(kMessage)]: 'connect ECONNREFUSED 172.24.1.153:443'
Aug 26 16:55:01 vlxsam02 samureye-app[79712]: }
Aug 26 16:55:01 vlxsam02 samureye-app[79712]: 4:55:01 PM [express] GET /api/system/settings 500 in 4ms :: {"message":"Failed to fetch system settiâ€¦
Aug 26 16:55:03 vlxsam02 samureye-app[79712]: WebSocket client connected
Aug 26 16:55:07 vlxsam02 samureye-app[79712]: WebSocket client disconnected
^C
root@vlxsam02:/opt/samureye# tail -f /var/log/samureye/*.log

ðŸ’» RECURSOS:
CPU: 0.0%
MemÃ³ria: 14.6%
Disco: 10%

ðŸ“ LOGS RECENTES (Ãºltimas 5 linhas):
âŒ Log da aplicaÃ§Ã£o nÃ£o encontrado

=== FIM DO HEALTH CHECK ===
^C
root@vlxsam02:/opt/samureye# ./scripts/health-check.sh
=== SAMUREYE APPLICATION HEALTH CHECK ===
Data: Tue Aug 26 04:55:37 PM -03 2025
Servidor: vlxsam02 (172.24.1.152)

âš¡ SYSTEMD SERVICES:
âœ… samureye-app: active

ðŸŒ ENDPOINTS:
âŒ App (5000): NÃ£o responde
âŒ System API (5000): NÃ£o responde

ðŸ—„ï¸ DATABASE CONNECTIVITY:
âœ… PostgreSQL (vlxsam03:5432): AcessÃ­vel
âœ… Redis (vlxsam03:6379): AcessÃ­vel

ðŸ”§ SECURITY TOOLS:
âœ… Nmap: Nmap version 7.94SVN ( https://nmap.org )
âœ… Nuclei:

ðŸ’» RECURSOS:
CPU: 2.3%
MemÃ³ria: 11.2%
Disco: 10%

ðŸ“ LOGS RECENTES (Ãºltimas 5 linhas):
âŒ Log da aplicaÃ§Ã£o nÃ£o encontrado

=== FIM DO HEALTH CHECK ===
root@vlxsam02:/opt/samureye# ./scripts/test-connectivity.sh
=== TESTE DE CONECTIVIDADE VLXSAM03 ===
Data: Tue Aug 26 04:55:57 PM -03 2025

ðŸ”— Testando PostgreSQL (172.24.1.153:5432)... âœ… Conectado
ðŸ”— Testando Redis (172.24.1.153:6379)... âœ… Conectado
ðŸ”— Testando MinIO (172.24.1.153:9000)... âœ… Conectado

ðŸŒ Testando Gateway (vlxsam01):
ðŸ”— Testando HTTP (172.24.1.151:80)... âœ… Conectado
ðŸ”— Testando HTTPS (172.24.1.151:443)... âœ… Conectado

ðŸ—„ï¸ Teste PostgreSQL avanÃ§ado:
âŒ Falha na autenticaÃ§Ã£o PostgreSQL

ðŸ” Teste DNS:
âœ… ResoluÃ§Ã£o DNS: OK


ðŸŒ InformaÃ§Ãµes de rede local:
IP do servidor: 172.24.1.152
Gateway: 172.24.1.254
DNS: 127.0.0.53

=== FIM DO TESTE ===
root@vlxsam02:/opt/samureye#