root@vlxsam04:~# curl -fsSL https://raw.githubusercontent.com/GruppenIT/SamurEye/refs/heads/main/docs/deployment/vlxsam04/fix-collector-config.sh | sudo bash
🔧 vlxsam04 - CORRIGIR CONFIGURAÇÃO COLLECTOR
==============================================

[14:42:47] 🔍 Detectando situação atual do collector...
[14:42:48] 📋 Serviço samureye-collector encontrado
[14:42:48] ✅ Serviço está ativo
[14:42:54] ⏹️ Serviço parado para reconfiguração
[14:42:54] 📁 Diretório encontrado: /opt/samureye-collector
[14:42:54] 👤 Criando usuário samureye...
[14:42:54] ⚙️ Criando configuração do collector...
[14:42:54] ✅ Configuração criada: /etc/samureye/collector.conf
[14:42:54] 📦 Verificando dependências Python...
[14:42:54] 🐍 Criando ambiente virtual Python...
[14:43:03] ✅ Dependências Python instaladas
[14:43:03] 🤖 Criando collector agent atualizado...
[14:43:03] ✅ Collector agent criado
[14:43:03] 🔧 Criando serviço systemd...
[14:43:03] 🔧 Ajustando permissões...
[14:43:03] 🚀 Habilitando e iniciando serviço...
[14:43:13] 🧪 Verificando funcionamento...
[14:43:13] ✅ Serviço ativo
[14:43:13] WARNING: ⚠️ Heartbeat ainda não confirmado
[14:43:13] 📝 Últimos logs:
Sep 01 14:43:03 vlxsam04 systemd[1]: Started samureye-collector.service - SamurEye Collector Agent - vlxsam04.
Sep 01 14:43:03 vlxsam04 samureye-collector[125544]: 2025-09-01 14:43:03,891 - samureye-collector - INFO - Iniciando SamurEye Collector Agent vlxsam04
Sep 01 14:43:03 vlxsam04 samureye-collector[125544]: 2025-09-01 14:43:03,891 - samureye-collector - INFO - Servidor: https://app.samureye.com.br
Sep 01 14:43:03 vlxsam04 samureye-collector[125544]: 2025-09-01 14:43:03,891 - samureye-collector - INFO - Hostname: vlxsam04
Sep 01 14:43:04 vlxsam04 samureye-collector[125544]: /opt/samureye-collector/venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host 'app.samureye.com.br'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
Sep 01 14:43:04 vlxsam04 samureye-collector[125544]:   warnings.warn(
Sep 01 14:43:04 vlxsam04 samureye-collector[125544]: 2025-09-01 14:43:04,942 - samureye-collector - WARNING - Tentativa 1 falhou, tentando novamente...
Sep 01 14:43:09 vlxsam04 samureye-collector[125544]: /opt/samureye-collector/venv/lib/python3.12/site-packages/urllib3/connectionpool.py:1097: InsecureRequestWarning: Unverified HTTPS request is being made to host 'app.samureye.com.br'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#tls-warnings
Sep 01 14:43:09 vlxsam04 samureye-collector[125544]:   warnings.warn(
Sep 01 14:43:09 vlxsam04 samureye-collector[125544]: 2025-09-01 14:43:09,992 - samureye-collector - WARNING - Tentativa 2 falhou, tentando novamente...

[14:43:13] 🎯 COLLECTOR CONFIGURADO COM SUCESSO
════════════════════════════════════════════════

📊 CONFIGURAÇÃO:
   ✓ Nome: vlxsam04
   ✓ Hostname: vlxsam04
   ✓ IP: 192.168.100.151
   ✓ Server: https://app.samureye.com.br

🔧 SERVIÇO:
   ✓ Status: Ativo
   ✓ Heartbeat: A cada 2 minutos
   ✓ Telemetria: CPU, memória, disco real

📁 ARQUIVOS:
   • Config: /etc/samureye/collector.conf
   • Agent: /opt/samureye-collector/collector_agent.py
   • Logs: /var/log/samureye/collector.log

📝 MONITORAMENTO:
   • Status: systemctl status samureye-collector
   • Logs: journalctl -u samureye-collector -f
   • Config: cat /etc/samureye/collector.conf

💡 PRÓXIMO PASSO:
   Verificar na interface se collector aparece online
   URL: https://app.samureye.com.br/collectors
root@vlxsam04:~#