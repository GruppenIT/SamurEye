root@vlxsam04:~# curl -fsSL https://raw.githubusercontent.com/GruppenIT/SamurEye/main/docs/deployment/vlxsam04/register-collector.sh | bash -s -- gruppen-it 97433dfa-498e-43c7-91f1-6e8d0a016b13

ğŸ”§ REGISTRO COLLECTOR SAMUREYE
==============================

[10:42:58] ğŸ” ParÃ¢metros recebidos:
   â€¢ Tenant Slug: gruppen-it
   â€¢ Token: 97433dfa...0a016b13
[10:42:58] ğŸ” Verificando prerequisitos...
[10:42:58] âœ… Prerequisitos verificados
[10:42:58] ğŸ” Coletando informaÃ§Ãµes do sistema...
[10:42:58]    â€¢ Hostname: vlxsam04
[10:42:58]    â€¢ IP Address: 192.168.100.151
[10:42:58] ğŸŒ Testando conectividade com API...
[10:42:58] âœ… Conectividade OK
[10:42:58] ğŸ”§ Registrando collector...
[10:42:58] ğŸ“¤ Enviando registro para API...
[10:42:58] ğŸ“¥ Processando resposta da API...
[10:42:58] ğŸ‰ COLLECTOR REGISTRADO COM SUCESSO!

[10:42:58] ğŸ“‹ DETALHES DO REGISTRO:
   â€¢ Nome do Collector: vlxsam04
   â€¢ Tenant: Gruppen it
   â€¢ Status: online
   â€¢ Hostname: vlxsam04
   â€¢ IP: 192.168.100.151

[10:42:58] ğŸ’¾ Salvando token de autenticaÃ§Ã£o...
[10:42:58] WARNING: âš ï¸  Token nÃ£o encontrado na resposta da API
   Registro reportado como sucesso mas token nÃ£o recebido
[10:42:58] âœ… Collector estÃ¡ online e enviando telemetria

[10:42:58] ğŸ¯ REGISTRO CONCLUÃDO COM SUCESSO!

ğŸ“‹ PRÃ“XIMOS PASSOS:
   â€¢ O collector jÃ¡ estÃ¡ enviando telemetria automaticamente
   â€¢ Verifique o status na interface de administraÃ§Ã£o
   â€¢ O collector aparecerÃ¡ como 'ONLINE' na gestÃ£o de coletores

[10:42:58] âœ… Script de registro finalizado
root@vlxsam04:~# tail -f /var/log/samureye-collector/collector.log
  File "/opt/samureye/collector/heartbeat.py", line 22, in <module>
    logging.FileHandler('/var/log/samureye-collector/heartbeat.log'),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1231, in __init__
    StreamHandler.__init__(self, self._open())
                                 ^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/samureye-collector/heartbeat.log'
Traceback (most recent call last):
  File "/opt/samureye/collector/heartbeat.py", line 22, in <module>
    logging.FileHandler('/var/log/samureye-collector/heartbeat.log'),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1231, in __init__
    StreamHandler.__init__(self, self._open())
                                 ^^^^^^^^^^^^
  File "/usr/lib/python3.12/logging/__init__.py", line 1263, in _open
    return open_func(self.baseFilename, self.mode,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/var/log/samureye-collector/heartbeat.log'
^C
root@vlxsam04:~# /opt/samureye/collector/scripts/check-status.sh
ğŸ” DIAGNÃ“STICO COLLECTOR vlxsam04
================================
ğŸ“‹ Sistema: vlxsam04 (192.168.100.151)

ğŸ¤– Status do ServiÃ§o:
â— samureye-collector.service - SamurEye Collector Agent
     Loaded: loaded (/etc/systemd/system/samureye-collector.service; enabled; preset: enabled)
     Active: activating (auto-restart) (Result: exit-code) since Thu 2025-09-04 10:43:11 -03; 6s ago
    Process: 286687 ExecStart=/usr/bin/python3 /opt/samureye/collector/heartbeat.py (code=exited, status=1/FAILURE)
   Main PID: 286687 (code=exited, status=1/FAILURE)
        CPU: 356ms

ğŸ“ Logs Recentes (Heartbeat):
âŒ Log de heartbeat nÃ£o encontrado

ğŸ”— Teste de Conectividade:
âœ… API acessÃ­vel (porta 443)
âœ… DNS funcionando

ğŸ“Š ConfiguraÃ§Ã£o:
âœ… Arquivo .env existe
COLLECTOR_ID=vlxsam04
COLLECTOR_NAME=
HOSTNAME=vlxsam04
IP_ADDRESS=
COLLECTOR_TOKEN=
âŒ Token nÃ£o encontrado

ğŸ” RecomendaÃ§Ãµes:
â€¢ Verificar interface: https://app.samureye.com.br/admin/collectors
â€¢ Monitorar logs: tail -f /var/log/samureye-collector/heartbeat.log
â€¢ Reiniciar se necessÃ¡rio: systemctl restart samureye-collector
root@vlxsam04:~#