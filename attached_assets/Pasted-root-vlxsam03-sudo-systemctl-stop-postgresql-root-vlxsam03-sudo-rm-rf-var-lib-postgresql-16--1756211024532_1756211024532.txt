root@vlxsam03:~# sudo systemctl stop postgresql
root@vlxsam03:~# sudo rm -rf /var/lib/postgresql/16/main
root@vlxsam03:~# sudo rm -rf /etc/postgresql/16/main
root@vlxsam03:~# sudo pg_dropcluster --stop 16 main || true
Error: specified cluster does not exist
root@vlxsam03:~# sudo pg_createcluster 16 main --start
Creating new PostgreSQL cluster 16/main ...
/usr/lib/postgresql/16/bin/initdb -D /var/lib/postgresql/16/main --auth-local peer --auth-host scram-sha-256 --no-instructions
The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "en_US.UTF-8".
The default database encoding has accordingly been set to "UTF8".
The default text search configuration will be set to "english".

Data page checksums are disabled.

fixing permissions on existing directory /var/lib/postgresql/16/main ... ok
creating subdirectories ... ok
selecting dynamic shared memory implementation ... posix
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting default time zone ... Etc/UTC
creating configuration files ... ok
running bootstrap script ... ok
performing post-bootstrap initialization ... ok
syncing data to disk ... ok
Ver Cluster Port Status Owner    Data directory              Log file
16  main    5432 online postgres /var/lib/postgresql/16/main /var/log/postgresql/postgresql-16-main.log
root@vlxsam03:~# sudo systemctl start postgresql
root@vlxsam03:~# sudo systemctl enable postgresql
Synchronizing state of postgresql.service with SysV service script with /usr/lib/systemd/systemd-sysv-install.
Executing: /usr/lib/systemd/systemd-sysv-install enable postgresql                               sudo -u postgres psql -c "CREATE USER samureye WITH PASSWORD 'SamurEye2024DB!';"
-bash: !': event not foundostgres psql -c "CREATE USER samureye WITH PASSWORD 'SamurEye2024DB!';"sudo -u postgres psql -c 'CREATE USER samureye WITH PASSWORD '"'"'SamurEye2024DB!'"'"';'
root@vlxsam03:~# sudo -u postgres psql -c "CREATE DATABASE samureye_db OWNER samureye;"rEye2024DB!'"'"';'
CREATE DATABASE# sudo -u postgres psql -c "CREATE DATABASE samureye_db OWNER samureye;"
root@vlxsam03:~# sudo -u postgres psql -c "ALTER USER samureye CREATEDB;"
ALTER ROLE                                                                                       sudo -u postgres psql -d samureye_db -c "CREATE EXTENSION IF NOT EXISTS \"uuid-ossp\";"
CREATE EXTENSION echo "host    all             all             172.24.1.0/24           md5" | sudo tee -a /etc/postgresql/16/main/pg_hba.conf
host    all             all             172.24.1.0/24           md524.1.0/24           md5" | sudo tee -a /etc/postgresql/16/main/pg_hba.conf
root@vlxsam03:~# sudo systemctl restart postgresql
root@vlxsam03:~# /opt/samureye/scripts/test-postgres-connection.sh
[12:24:12] üêò Testando conectividade PostgreSQL local...
[12:24:12] Testando conex√£o com banco samureye_db...
[12:24:12] ‚úÖ Conex√£o PostgreSQL: OK
[12:24:12] ‚ö° Lat√™ncia local: 42ms
[12:24:12] üìä Tabelas encontradas: 0
[12:24:12] üîç Verificando estrutura do banco...
[12:24:12] ‚ö†Ô∏è Tabela 'users': n√£o encontrada
[12:24:12] ‚ö†Ô∏è Tabela 'tenants': n√£o encontrada
[12:24:12] ‚ö†Ô∏è Tabela 'collectors': n√£o encontrada
[12:24:12] üîß Verificando extens√µes...
[12:24:12] ‚úÖ Extens√£o 'uuid-ossp': instalada
[12:24:12] Teste PostgreSQL local conclu√≠do
root@vlxsam03:~#