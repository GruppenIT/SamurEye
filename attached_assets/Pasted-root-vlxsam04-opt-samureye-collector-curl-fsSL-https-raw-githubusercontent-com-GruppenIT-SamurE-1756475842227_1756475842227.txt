root@vlxsam04:/opt/samureye-collector# curl -fsSL https://raw.githubusercontent.com/GruppenIT/SamurEye/refs/heads/main/docs/deployment/vlxsam04/install.sh | sudo bash
[13:55:03] üöÄ Iniciando instala√ß√£o vlxsam04 - Collector Agent
[13:55:03] Servidor: 192.168.100.151 (rede interna isolada)
[13:55:03] Collector Directory: /opt/samureye-collector
[13:55:03] üì¶ Atualizando sistema base...
Hit:1 https://deb.nodesource.com/node_20.x nodistro InRelease
Hit:2 http://archive.ubuntu.com/ubuntu noble InRelease
Get:3 http://security.ubuntu.com/ubuntu noble-security InRelease [126 kB]
Get:4 http://archive.ubuntu.com/ubuntu noble-updates InRelease [126 kB]
Get:5 http://security.ubuntu.com/ubuntu noble-security/main amd64 Packages [1,106 kB]
Get:6 http://archive.ubuntu.com/ubuntu noble-backports InRelease [126 kB]
Get:7 http://security.ubuntu.com/ubuntu noble-security/main amd64 Components [21.5 kB]
Get:8 http://security.ubuntu.com/ubuntu noble-security/main amd64 c-n-f Metadata [8,708 B]
Get:9 http://security.ubuntu.com/ubuntu noble-security/restricted amd64 Components [208 B]
Get:10 http://security.ubuntu.com/ubuntu noble-security/universe amd64 Packages [881 kB]
Get:11 http://security.ubuntu.com/ubuntu noble-security/universe amd64 Components [52.2 kB]
Get:12 http://security.ubuntu.com/ubuntu noble-security/multiverse amd64 Components [212 B]
Get:13 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 Packages [1,379 kB]
Get:14 http://archive.ubuntu.com/ubuntu noble-updates/main Translation-en [272 kB]
Get:15 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 Components [175 kB]
Get:16 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 c-n-f Metadata [14.9 kB]
Get:17 http://archive.ubuntu.com/ubuntu noble-updates/restricted amd64 Packages [1,785 kB]
Get:18 http://archive.ubuntu.com/ubuntu noble-updates/restricted Translation-en [399 kB]
Get:19 http://archive.ubuntu.com/ubuntu noble-updates/restricted amd64 Components [212 B]
Get:20 http://archive.ubuntu.com/ubuntu noble-updates/universe amd64 Packages [1,474 kB]
Get:21 http://archive.ubuntu.com/ubuntu noble-updates/universe Translation-en [297 kB]
Get:22 http://archive.ubuntu.com/ubuntu noble-updates/universe amd64 Components [377 kB]
Get:23 http://archive.ubuntu.com/ubuntu noble-updates/universe amd64 c-n-f Metadata [30.5 kB]
Get:24 http://archive.ubuntu.com/ubuntu noble-updates/multiverse amd64 Components [940 B]
Get:25 http://archive.ubuntu.com/ubuntu noble-backports/main amd64 Components [7,092 B]
Get:26 http://archive.ubuntu.com/ubuntu noble-backports/restricted amd64 Components [216 B]
Get:27 http://archive.ubuntu.com/ubuntu noble-backports/universe amd64 Components [19.2 kB]
Get:28 http://archive.ubuntu.com/ubuntu noble-backports/multiverse amd64 Components [212 B]
Fetched 8,680 kB in 7s (1,169 kB/s)
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
4 packages can be upgraded. Run 'apt list --upgradable' to see them.
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
Calculating upgrade... Done
The following packages will be upgraded:
  fwupd libfwupd2 libudisks2-0 udisks2
4 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
2 standard LTS security updates
Need to get 5,200 kB of archives.
After this operation, 4,096 B of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 libfwupd2 amd64 1.9.31-0ubuntu1~24.04.1 [136 kB]
Get:2 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 fwupd amd64 1.9.31-0ubuntu1~24.04.1 [4,592 kB]
Get:3 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 udisks2 amd64 2.10.1-6ubuntu1.3 [297 kB]
Get:4 http://archive.ubuntu.com/ubuntu noble-updates/main amd64 libudisks2-0 amd64 2.10.1-6ubuntu1.3 [175 kB]
Fetched 5,200 kB in 2s (2,331 kB/s)
(Reading database ... 135319 files and directories currently installed.)
Preparing to unpack .../libfwupd2_1.9.31-0ubuntu1~24.04.1_amd64.deb ...
Unpacking libfwupd2:amd64 (1.9.31-0ubuntu1~24.04.1) over (1.9.30-0ubuntu1~24.04.1) ...
Preparing to unpack .../fwupd_1.9.31-0ubuntu1~24.04.1_amd64.deb ...
Unpacking fwupd (1.9.31-0ubuntu1~24.04.1) over (1.9.30-0ubuntu1~24.04.1) ...
Preparing to unpack .../udisks2_2.10.1-6ubuntu1.3_amd64.deb ...
Unpacking udisks2 (2.10.1-6ubuntu1.3) over (2.10.1-6ubuntu1.2) ...
Preparing to unpack .../libudisks2-0_2.10.1-6ubuntu1.3_amd64.deb ...
Unpacking libudisks2-0:amd64 (2.10.1-6ubuntu1.3) over (2.10.1-6ubuntu1.2) ...
Setting up libfwupd2:amd64 (1.9.31-0ubuntu1~24.04.1) ...
Setting up fwupd (1.9.31-0ubuntu1~24.04.1) ...
fwupd-offline-update.service is a disabled or a static unit not running, not starting it.
fwupd-refresh.service is a disabled or a static unit not running, not starting it.
fwupd.service is a disabled or a static unit not running, not starting it.
Setting up libudisks2-0:amd64 (2.10.1-6ubuntu1.3) ...
Setting up udisks2 (2.10.1-6ubuntu1.3) ...
Processing triggers for man-db (2.12.0-4build2) ...
Processing triggers for dbus (1.14.10-4ubuntu4.1) ...
Processing triggers for libc-bin (2.39-0ubuntu8.5) ...
Scanning processes...
Scanning candidates...
Scanning linux images...

Pending kernel upgrade!
Running kernel version:
  6.8.0-41-generic
Diagnostics:
  The currently running kernel version is not the expected kernel version 6.8.0-79-generic.

Restarting the system to load the new kernel will not be handled automatically, so you should consider rebooting.

Restarting services...

Service restarts being deferred:
 /etc/needrestart/restart.d/dbus.service
 systemctl restart getty@tty1.service
 systemctl restart systemd-logind.service
 systemctl restart unattended-upgrades.service

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
curl is already the newest version (8.5.0-2ubuntu10.6).
wget is already the newest version (1.21.4-1ubuntu4.1).
gnupg is already the newest version (2.4.4-2ubuntu17.3).
software-properties-common is already the newest version (0.99.49.3).
apt-transport-https is already the newest version (2.8.3).
ca-certificates is already the newest version (20240203).
lsb-release is already the newest version (12.0-2).
jq is already the newest version (1.7.1-3ubuntu0.24.04.1).
htop is already the newest version (3.3.0-4build1).
iotop is already the newest version (0.6-42-ga14256a-0.2build1).
netcat-openbsd is already the newest version (1.226-1ubuntu2).
net-tools is already the newest version (2.10-0.1ubuntu4.4).
dnsutils is already the newest version (1:9.18.30-0ubuntu0.24.04.2).
tcpdump is already the newest version (4.99.4-3ubuntu4).
python3.12 is already the newest version (3.12.3-1ubuntu0.8).
python3.12-venv is already the newest version (3.12.3-1ubuntu0.8).
python3.12-dev is already the newest version (3.12.3-1ubuntu0.8).
python3-pip is already the newest version (24.0+dfsg-1ubuntu1.2).
build-essential is already the newest version (12.10ubuntu1).
git is already the newest version (1:2.43.0-1ubuntu7.3).
unzip is already the newest version (6.0-28ubuntu4.1).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
[13:55:32] Sistema base atualizado
[13:55:32] üü¢ Instalando Node.js 20.x...
2025-08-29 13:55:32 - Installing pre-requisites
Hit:1 https://deb.nodesource.com/node_20.x nodistro InRelease
Hit:2 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:3 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:4 http://archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:5 http://archive.ubuntu.com/ubuntu noble-backports InRelease
Reading package lists... Done
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
apt-transport-https is already the newest version (2.8.3).
ca-certificates is already the newest version (20240203).
curl is already the newest version (8.5.0-2ubuntu10.6).
gnupg is already the newest version (2.4.4-2ubuntu17.3).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Hit:1 https://deb.nodesource.com/node_20.x nodistro InRelease
Hit:2 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:3 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:4 http://archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:5 http://archive.ubuntu.com/ubuntu noble-backports InRelease
Reading package lists... Done
2025-08-29 13:55:38 - Repository configured successfully.
2025-08-29 13:55:38 - To install Node.js, run: apt-get install nodejs -y
2025-08-29 13:55:38 - You can use N|solid Runtime as a node.js alternative
2025-08-29 13:55:38 - To install N|solid Runtime, run: apt-get install nsolid -y

Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
nodejs is already the newest version (20.19.4-1nodesource1).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
[13:55:38] Node.js instalado: v20.19.4
[13:55:38] npm instalado: 10.8.2
[13:55:38] üêç Configurando Python 3.12...
[13:55:38] Configurando pip para Python 3.12...
[13:55:39] ‚úÖ pip funcionando, atualizando com --break-system-packages (Ubuntu 24.04)...
Requirement already satisfied: pip in /usr/lib/python3/dist-packages (24.0)
Collecting pip
  Using cached pip-25.2-py3-none-any.whl.metadata (4.7 kB)
Requirement already satisfied: setuptools in /usr/lib/python3/dist-packages (68.1.2)
Collecting setuptools
  Using cached setuptools-80.9.0-py3-none-any.whl.metadata (6.6 kB)
Requirement already satisfied: wheel in /usr/lib/python3/dist-packages (0.42.0)
Collecting wheel
  Using cached wheel-0.45.1-py3-none-any.whl.metadata (2.3 kB)
Using cached pip-25.2-py3-none-any.whl (1.8 MB)
Using cached setuptools-80.9.0-py3-none-any.whl (1.2 MB)
Using cached wheel-0.45.1-py3-none-any.whl (72 kB)
Installing collected packages: wheel, setuptools, pip
  Attempting uninstall: wheel
    Found existing installation: wheel 0.42.0
[13:55:41] ‚ö†Ô∏è Pip upgrade falhou, usando vers√£o do sistema...
[13:55:41] üì¶ Instalando depend√™ncias Python...
Requirement already satisfied: aiohttp in /usr/local/lib/python3.12/dist-packages (3.12.15)
Requirement already satisfied: websockets in /usr/local/lib/python3.12/dist-packages (15.0.1)
Requirement already satisfied: cryptography in /usr/lib/python3/dist-packages (41.0.7)
Requirement already satisfied: requests in /usr/lib/python3/dist-packages (2.31.0)
Requirement already satisfied: certifi in /usr/lib/python3/dist-packages (2023.11.17)
Requirement already satisfied: psutil in /usr/local/lib/python3.12/dist-packages (7.0.0)
Requirement already satisfied: pyyaml in /usr/lib/python3/dist-packages (6.0.1)
Requirement already satisfied: structlog in /usr/local/lib/python3.12/dist-packages (25.4.0)
Requirement already satisfied: python-multipart in /usr/local/lib/python3.12/dist-packages (0.0.20)
Requirement already satisfied: aiofiles in /usr/local/lib/python3.12/dist-packages (24.1.0)
Requirement already satisfied: aiohappyeyeballs>=2.5.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp) (2.6.1)
Requirement already satisfied: aiosignal>=1.4.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp) (1.4.0)
Requirement already satisfied: attrs>=17.3.0 in /usr/lib/python3/dist-packages (from aiohttp) (23.2.0)
Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.12/dist-packages (from aiohttp) (1.7.0)
Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.12/dist-packages (from aiohttp) (6.6.4)
Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp) (0.3.2)
Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.12/dist-packages (from aiohttp) (1.20.1)
Requirement already satisfied: typing-extensions>=4.2 in /usr/local/lib/python3.12/dist-packages (from aiosignal>=1.4.0->aiohttp) (4.15.0)
Requirement already satisfied: idna>=2.0 in /usr/lib/python3/dist-packages (from yarl<2.0,>=1.17.0->aiohttp) (3.6)
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
[13:55:42] Python 3.12 e depend√™ncias instaladas
[13:55:42] üîç Validando compatibilidade Ubuntu 24.04...
[13:55:42] Ubuntu detectado: 24.04 (noble)
[13:55:42] ‚úÖ Ubuntu 24.04 Noble detectado - compatibilidade OK
[13:55:42] üß™ Testando componentes instalados...
[13:55:42] ‚úÖ Python 3.12: Python 3.12.3
[13:55:42] Testando importa√ß√µes Python...
‚úÖ Todas as depend√™ncias Python importadas com sucesso
‚úÖ Python path: /usr/bin/python3
[13:55:43] ‚úÖ netcat-openbsd dispon√≠vel: /usr/bin/nc
[13:55:43] ‚úÖ Node.js 20.x: v20.19.4
[13:55:43] üéâ Valida√ß√£o de compatibilidade conclu√≠da com sucesso!
[13:55:43] üë§ Configurando usu√°rio collector...
[13:55:43] Usu√°rio e diret√≥rios configurados
[13:55:43] üîß Instalando ferramentas de seguran√ßa...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
nmap is already the newest version (7.94+git20230807.3be01efb1+dfsg-3build2).
nmap-common is already the newest version (7.94+git20230807.3be01efb1+dfsg-3build2).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  masscan
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 237 kB of archives.
After this operation, 566 kB of additional disk space will be used.
Err:1 http://archive.ubuntu.com/ubuntu noble/universe amd64 masscan amd64 2:1.3.2+ds1-1
  403  Forbidden [IP: 185.125.190.82 80]
[13:55:46] ‚ö†Ô∏è Masscan via apt falhou, compilando do source...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
build-essential is already the newest version (12.10ubuntu1).
git is already the newest version (1:2.43.0-1ubuntu7.3).
libpcap-dev is already the newest version (1.10.4-4.1ubuntu3).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Cloning into 'masscan'...
remote: Enumerating objects: 6349, done.
remote: Total 6349 (delta 0), reused 0 (delta 0), pack-reused 6349 (from 1)
Receiving objects: 100% (6349/6349), 3.56 MiB | 16.41 MiB/s, done.
Resolving deltas: 100% (4619/4619), done.
cc -g -ggdb    -Wall -O2 -c src/crypto-base64.c -o tmp/crypto-base64.o
cc -g -ggdb    -Wall -O2 -c src/crypto-blackrock.c -o tmp/crypto-blackrock.o
cc -g -ggdb    -Wall -O2 -c src/crypto-blackrock2.c -o tmp/crypto-blackrock2.o
cc -g -ggdb    -Wall -O2 -c src/crypto-lcg.c -o tmp/crypto-lcg.o
cc -g -ggdb    -Wall -O2 -c src/crypto-primegen.c -o tmp/crypto-primegen.o
cc -g -ggdb    -Wall -O2 -c src/crypto-siphash24.c -o tmp/crypto-siphash24.o
cc -g -ggdb    -Wall -O2 -c src/event-timeout.c -o tmp/event-timeout.o
cc -g -ggdb    -Wall -O2 -c src/in-binary.c -o tmp/in-binary.o
cc -g -ggdb    -Wall -O2 -c src/in-filter.c -o tmp/in-filter.o
cc -g -ggdb    -Wall -O2 -c src/in-report.c -o tmp/in-report.o
cc -g -ggdb    -Wall -O2 -c src/main-conf.c -o tmp/main-conf.o -DGIT=\"1.3.2-213-gb99d433\"
cc -g -ggdb    -Wall -O2 -c src/main-dedup.c -o tmp/main-dedup.o
cc -g -ggdb    -Wall -O2 -c src/main-initadapter.c -o tmp/main-initadapter.o
cc -g -ggdb    -Wall -O2 -c src/main-listscan.c -o tmp/main-listscan.o
cc -g -ggdb    -Wall -O2 -c src/main-ptrace.c -o tmp/main-ptrace.o
cc -g -ggdb    -Wall -O2 -c src/main-readrange.c -o tmp/main-readrange.o
cc -g -ggdb    -Wall -O2 -c src/main-status.c -o tmp/main-status.o
cc -g -ggdb    -Wall -O2 -c src/main-throttle.c -o tmp/main-throttle.o
cc -g -ggdb    -Wall -O2 -c src/main.c -o tmp/main.o
cc -g -ggdb    -Wall -O2 -c src/masscan-app.c -o tmp/masscan-app.o
cc -g -ggdb    -Wall -O2 -c src/massip-addr.c -o tmp/massip-addr.o
cc -g -ggdb    -Wall -O2 -c src/massip-parse.c -o tmp/massip-parse.o
cc -g -ggdb    -Wall -O2 -c src/massip-rangesv4.c -o tmp/massip-rangesv4.o
cc -g -ggdb    -Wall -O2 -c src/massip-rangesv6.c -o tmp/massip-rangesv6.o
cc -g -ggdb    -Wall -O2 -c src/massip.c -o tmp/massip.o
cc -g -ggdb    -Wall -O2 -c src/misc-rstfilter.c -o tmp/misc-rstfilter.o
cc -g -ggdb    -Wall -O2 -c src/out-binary.c -o tmp/out-binary.o
cc -g -ggdb    -Wall -O2 -c src/out-certs.c -o tmp/out-certs.o
cc -g -ggdb    -Wall -O2 -c src/out-grepable.c -o tmp/out-grepable.o
cc -g -ggdb    -Wall -O2 -c src/out-hostonly.c -o tmp/out-hostonly.o
cc -g -ggdb    -Wall -O2 -c src/out-json.c -o tmp/out-json.o
cc -g -ggdb    -Wall -O2 -c src/out-ndjson.c -o tmp/out-ndjson.o
cc -g -ggdb    -Wall -O2 -c src/out-null.c -o tmp/out-null.o
cc -g -ggdb    -Wall -O2 -c src/out-redis.c -o tmp/out-redis.o
cc -g -ggdb    -Wall -O2 -c src/out-tcp-services.c -o tmp/out-tcp-services.o
cc -g -ggdb    -Wall -O2 -c src/out-text.c -o tmp/out-text.o
cc -g -ggdb    -Wall -O2 -c src/out-unicornscan.c -o tmp/out-unicornscan.o
cc -g -ggdb    -Wall -O2 -c src/out-xml.c -o tmp/out-xml.o
cc -g -ggdb    -Wall -O2 -c src/output.c -o tmp/output.o
cc -g -ggdb    -Wall -O2 -c src/pixie-backtrace.c -o tmp/pixie-backtrace.o
cc -g -ggdb    -Wall -O2 -c src/pixie-file.c -o tmp/pixie-file.o
cc -g -ggdb    -Wall -O2 -c src/pixie-threads.c -o tmp/pixie-threads.o
cc -g -ggdb    -Wall -O2 -c src/pixie-timer.c -o tmp/pixie-timer.o
cc -g -ggdb    -Wall -O2 -c src/proto-arp.c -o tmp/proto-arp.o
cc -g -ggdb    -Wall -O2 -c src/proto-banner1.c -o tmp/proto-banner1.o
cc -g -ggdb    -Wall -O2 -c src/proto-banout.c -o tmp/proto-banout.o
cc -g -ggdb    -Wall -O2 -c src/proto-coap.c -o tmp/proto-coap.o
cc -g -ggdb    -Wall -O2 -c src/proto-dns.c -o tmp/proto-dns.o
cc -g -ggdb    -Wall -O2 -c src/proto-ftp.c -o tmp/proto-ftp.o
cc -g -ggdb    -Wall -O2 -c src/proto-http.c -o tmp/proto-http.o
cc -g -ggdb    -Wall -O2 -c src/proto-icmp.c -o tmp/proto-icmp.o
cc -g -ggdb    -Wall -O2 -c src/proto-imap4.c -o tmp/proto-imap4.o
cc -g -ggdb    -Wall -O2 -c src/proto-isakmp.c -o tmp/proto-isakmp.o
cc -g -ggdb    -Wall -O2 -c src/proto-mc.c -o tmp/proto-mc.o
cc -g -ggdb    -Wall -O2 -c src/proto-memcached.c -o tmp/proto-memcached.o
cc -g -ggdb    -Wall -O2 -c src/proto-netbios.c -o tmp/proto-netbios.o
cc -g -ggdb    -Wall -O2 -c src/proto-ntlmssp.c -o tmp/proto-ntlmssp.o
cc -g -ggdb    -Wall -O2 -c src/proto-ntp.c -o tmp/proto-ntp.o
cc -g -ggdb    -Wall -O2 -c src/proto-oproto.c -o tmp/proto-oproto.o
cc -g -ggdb    -Wall -O2 -c src/proto-pop3.c -o tmp/proto-pop3.o
cc -g -ggdb    -Wall -O2 -c src/proto-preprocess.c -o tmp/proto-preprocess.o
cc -g -ggdb    -Wall -O2 -c src/proto-sctp.c -o tmp/proto-sctp.o
cc -g -ggdb    -Wall -O2 -c src/proto-smb.c -o tmp/proto-smb.o
cc -g -ggdb    -Wall -O2 -c src/proto-smtp.c -o tmp/proto-smtp.o
cc -g -ggdb    -Wall -O2 -c src/proto-snmp.c -o tmp/proto-snmp.o
cc -g -ggdb    -Wall -O2 -c src/proto-ssh.c -o tmp/proto-ssh.o
cc -g -ggdb    -Wall -O2 -c src/proto-ssl-test.c -o tmp/proto-ssl-test.o
cc -g -ggdb    -Wall -O2 -c src/proto-ssl.c -o tmp/proto-ssl.o
cc -g -ggdb    -Wall -O2 -c src/proto-tcp-rdp.c -o tmp/proto-tcp-rdp.o
cc -g -ggdb    -Wall -O2 -c src/proto-tcp-telnet.c -o tmp/proto-tcp-telnet.o
cc -g -ggdb    -Wall -O2 -c src/proto-udp.c -o tmp/proto-udp.o
cc -g -ggdb    -Wall -O2 -c src/proto-versioning.c -o tmp/proto-versioning.o
cc -g -ggdb    -Wall -O2 -c src/proto-vnc.c -o tmp/proto-vnc.o
cc -g -ggdb    -Wall -O2 -c src/proto-x509.c -o tmp/proto-x509.o
cc -g -ggdb    -Wall -O2 -c src/proto-zeroaccess.c -o tmp/proto-zeroaccess.o
cc -g -ggdb    -Wall -O2 -c src/rawsock-getif.c -o tmp/rawsock-getif.o
cc -g -ggdb    -Wall -O2 -c src/rawsock-getip.c -o tmp/rawsock-getip.o
cc -g -ggdb    -Wall -O2 -c src/rawsock-getip6.c -o tmp/rawsock-getip6.o
cc -g -ggdb    -Wall -O2 -c src/rawsock-getmac.c -o tmp/rawsock-getmac.o
cc -g -ggdb    -Wall -O2 -c src/rawsock-getroute.c -o tmp/rawsock-getroute.o
cc -g -ggdb    -Wall -O2 -c src/rawsock-pcapfile.c -o tmp/rawsock-pcapfile.o
cc -g -ggdb    -Wall -O2 -c src/rawsock.c -o tmp/rawsock.o
cc -g -ggdb    -Wall -O2 -c src/read-service-probes.c -o tmp/read-service-probes.o
cc -g -ggdb    -Wall -O2 -c src/rte-ring.c -o tmp/rte-ring.o
cc -g -ggdb    -Wall -O2 -c src/scripting-banner.c -o tmp/scripting-banner.o
cc -g -ggdb    -Wall -O2 -c src/scripting-masscan.c -o tmp/scripting-masscan.o
cc -g -ggdb    -Wall -O2 -c src/scripting.c -o tmp/scripting.o
cc -g -ggdb    -Wall -O2 -c src/smack1.c -o tmp/smack1.o
cc -g -ggdb    -Wall -O2 -c src/smackqueue.c -o tmp/smackqueue.o
cc -g -ggdb    -Wall -O2 -c src/stack-arpv4.c -o tmp/stack-arpv4.o
cc -g -ggdb    -Wall -O2 -c src/stack-if.c -o tmp/stack-if.o
cc -g -ggdb    -Wall -O2 -c src/stack-ndpv6.c -o tmp/stack-ndpv6.o
cc -g -ggdb    -Wall -O2 -c src/stack-queue.c -o tmp/stack-queue.o
cc -g -ggdb    -Wall -O2 -c src/stack-src.c -o tmp/stack-src.o
cc -g -ggdb    -Wall -O2 -c src/stack-tcp-app.c -o tmp/stack-tcp-app.o
cc -g -ggdb    -Wall -O2 -c src/stack-tcp-core.c -o tmp/stack-tcp-core.o
cc -g -ggdb    -Wall -O2 -c src/stub-lua.c -o tmp/stub-lua.o
cc -g -ggdb    -Wall -O2 -c src/stub-pcap.c -o tmp/stub-pcap.o
cc -g -ggdb    -Wall -O2 -c src/stub-pfring.c -o tmp/stub-pfring.o
cc -g -ggdb    -Wall -O2 -c src/syn-cookie.c -o tmp/syn-cookie.o
cc -g -ggdb    -Wall -O2 -c src/templ-nmap-payloads.c -o tmp/templ-nmap-payloads.o
cc -g -ggdb    -Wall -O2 -c src/templ-payloads.c -o tmp/templ-payloads.o
cc -g -ggdb    -Wall -O2 -c src/templ-pkt.c -o tmp/templ-pkt.o
cc -g -ggdb    -Wall -O2 -c src/templ-tcp-hdr.c -o tmp/templ-tcp-hdr.o
cc -g -ggdb    -Wall -O2 -c src/util-checksum.c -o tmp/util-checksum.o
cc -g -ggdb    -Wall -O2 -c src/util-errormsg.c -o tmp/util-errormsg.o
cc -g -ggdb    -Wall -O2 -c src/util-extract.c -o tmp/util-extract.o
cc -g -ggdb    -Wall -O2 -c src/util-logger.c -o tmp/util-logger.o
cc -g -ggdb    -Wall -O2 -c src/util-malloc.c -o tmp/util-malloc.o
cc -g -ggdb    -Wall -O2 -c src/util-safefunc.c -o tmp/util-safefunc.o
cc -g -ggdb    -Wall -O2 -c src/vulncheck-heartbleed.c -o tmp/vulncheck-heartbleed.o
cc -g -ggdb    -Wall -O2 -c src/vulncheck-ntp-monlist.c -o tmp/vulncheck-ntp-monlist.o
cc -g -ggdb    -Wall -O2 -c src/vulncheck-sslv3.c -o tmp/vulncheck-sslv3.o
cc -g -ggdb    -Wall -O2 -c src/vulncheck.c -o tmp/vulncheck.o
cc -g -ggdb    -Wall -O2 -c src/xring.c -o tmp/xring.o
cc -g -ggdb    -Wall -O2 -o bin/masscan tmp/crypto-base64.o tmp/crypto-blackrock.o tmp/crypto-blackrock2.o tmp/crypto-lcg.o tmp/crypto-primegen.o tmp/crypto-siphash24.o tmp/event-timeout.o tmp/in-binary.o tmp/in-filter.o tmp/in-report.o tmp/main-conf.o tmp/main-dedup.o tmp/main-initadapter.o tmp/main-listscan.o tmp/main-ptrace.o tmp/main-readrange.o tmp/main-status.o tmp/main-throttle.o tmp/main.o tmp/masscan-app.o tmp/massip-addr.o tmp/massip-parse.o tmp/massip-rangesv4.o tmp/massip-rangesv6.o tmp/massip.o tmp/misc-rstfilter.o tmp/out-binary.o tmp/out-certs.o tmp/out-grepable.o tmp/out-hostonly.o tmp/out-json.o tmp/out-ndjson.o tmp/out-null.o tmp/out-redis.o tmp/out-tcp-services.o tmp/out-text.o tmp/out-unicornscan.o tmp/out-xml.o tmp/output.o tmp/pixie-backtrace.o tmp/pixie-file.o tmp/pixie-threads.o tmp/pixie-timer.o tmp/proto-arp.o tmp/proto-banner1.o tmp/proto-banout.o tmp/proto-coap.o tmp/proto-dns.o tmp/proto-ftp.o tmp/proto-http.o tmp/proto-icmp.o tmp/proto-imap4.o tmp/proto-isakmp.o tmp/proto-mc.o tmp/proto-memcached.o tmp/proto-netbios.o tmp/proto-ntlmssp.o tmp/proto-ntp.o tmp/proto-oproto.o tmp/proto-pop3.o tmp/proto-preprocess.o tmp/proto-sctp.o tmp/proto-smb.o tmp/proto-smtp.o tmp/proto-snmp.o tmp/proto-ssh.o tmp/proto-ssl-test.o tmp/proto-ssl.o tmp/proto-tcp-rdp.o tmp/proto-tcp-telnet.o tmp/proto-udp.o tmp/proto-versioning.o tmp/proto-vnc.o tmp/proto-x509.o tmp/proto-zeroaccess.o tmp/rawsock-getif.o tmp/rawsock-getip.o tmp/rawsock-getip6.o tmp/rawsock-getmac.o tmp/rawsock-getroute.o tmp/rawsock-pcapfile.o tmp/rawsock.o tmp/read-service-probes.o tmp/rte-ring.o tmp/scripting-banner.o tmp/scripting-masscan.o tmp/scripting.o tmp/smack1.o tmp/smackqueue.o tmp/stack-arpv4.o tmp/stack-if.o tmp/stack-ndpv6.o tmp/stack-queue.o tmp/stack-src.o tmp/stack-tcp-app.o tmp/stack-tcp-core.o tmp/stub-lua.o tmp/stub-pcap.o tmp/stub-pfring.o tmp/syn-cookie.o tmp/templ-nmap-payloads.o tmp/templ-payloads.o tmp/templ-pkt.o tmp/templ-tcp-hdr.o tmp/util-checksum.o tmp/util-errormsg.o tmp/util-extract.o tmp/util-logger.o tmp/util-malloc.o tmp/util-safefunc.o tmp/vulncheck-heartbleed.o tmp/vulncheck-ntp-monlist.o tmp/vulncheck-sslv3.o tmp/vulncheck.o tmp/xring.o   -lm -lrt -ldl -lpthread
install -pDm755 bin/masscan /usr/bin/masscan
[13:55:53] ‚úÖ Masscan compilado e instalado

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.1.0

                projectdiscovery.io

[INF] No new updates found for nuclei templates
[13:55:57] Ferramentas de seguran√ßa instaladas
[13:55:57] üîê Instalando step-ca client...
[13:55:58] step-ca client instalado: Smallstep CLI/0.25.2 (linux/amd64)
Release Date: 2024-01-19T21:15:39Z
[13:55:58] step-ca client configurado
[13:55:58] ü§ñ Configurando agente collector...
[13:55:58] Agente collector configurado
[13:55:58] üîß Configurando vari√°veis de ambiente...
[13:55:58] Vari√°veis de ambiente configuradas
[13:55:58] ‚öôÔ∏è Configurando servi√ßos systemd...
Created symlink /etc/systemd/system/multi-user.target.wants/samureye-collector.service ‚Üí /etc/systemd/system/samureye-collector.service.
[13:56:02] ‚úÖ Servi√ßo samureye-collector iniciado com sucesso
[13:56:02] Servi√ßos systemd configurados
[13:56:02] üìù Criando scripts auxiliares...
[13:56:02] Script de registro criado: /opt/samureye-collector/register-collector.sh
[13:56:02] Scripts auxiliares criados
[13:56:02] üìä Configurando sistema de logs...
[13:56:02] Sistema de logs configurado
[13:56:02] ‚úÖ Executando valida√ß√£o final...
[13:56:02] üîç Verificando masscan...
[13:56:02] ‚úÖ Masscan encontrado em /usr/bin/masscan
[13:56:02] ‚úÖ Ferramenta OK: nmap --version
[13:56:03] ‚úÖ Ferramenta OK: nuclei -version
[13:56:03] ‚úÖ Ferramenta OK: gobuster version
[13:56:03] ‚úÖ Ferramenta OK: step version
[13:56:03] ‚úÖ Ferramenta OK: python3 --version
[13:56:03] ‚úÖ Ferramenta OK: node --version
[13:56:03] ‚úÖ Servi√ßo samureye-collector habilitado
[13:56:03] ‚úÖ Arquivo .env acess√≠vel
[13:56:03] üéâ Valida√ß√£o final conclu√≠da com sucesso!
[13:56:03] üìã Instala√ß√£o conclu√≠da - Resumo:
[13:56:03] Collector ID ser√° gerado automaticamente no primeiro boot
[13:56:03] Usu√°rio: samureye-collector
[13:56:03] Diret√≥rio base: /opt/samureye-collector
[13:56:03] Logs: /var/log/samureye-collector/
[13:56:03]
[13:56:03] üîß Comandos √∫teis:
[13:56:03]   systemctl start samureye-collector    # Iniciar collector
[13:56:03]   systemctl status samureye-collector   # Ver status
[13:56:03]   journalctl -f -u samureye-collector   # Ver logs em tempo real
[13:56:03]
[13:56:03] ‚ö†Ô∏è  PR√ìXIMOS PASSOS MANUAIS:
[13:56:03] 1. Executar script de registro LOCAL do collector:
[13:56:03]    cd /opt/samureye-collector && sudo ./register-collector.sh <tenant-slug> <collector-name>
[13:56:03]
[13:56:03]    Exemplo:
[13:56:03]    cd /opt/samureye-collector && sudo ./register-collector.sh gruppenIT vlxsam04-collector
[13:56:03]
[13:56:03] 2. O script de registro LOCAL ir√°:
[13:56:03]    - Gerar certificados mTLS via step-ca
[13:56:03]    - Registrar collector na plataforma SamurEye
[13:56:03]    - Configurar autentica√ß√£o segura
[13:56:03]    - Reiniciar servi√ßos automaticamente
[13:56:03]    - Verificar conectividade com a plataforma
[13:56:03]
[13:56:03] 3. Scripts auxiliares criados:
[13:56:03]    üìÑ /opt/samureye-collector/register-collector.sh - Script de registro
[13:56:03]    üìÑ /opt/samureye-collector/scripts/health-check.py - Verifica√ß√£o de sa√∫de
[13:56:03]    üìÑ /opt/samureye-collector/scripts/backup.sh - Backup de configura√ß√µes
[13:56:03]
[13:56:03] üöÄ vlxsam04 Collector Agent pronto para registro LOCAL!
root@vlxsam04:/opt/samureye-collector# cd /opt/samureye-collector && sudo ./register-collector.sh gruppen-it vlxsam04
üîß Registro Simplificado do Collector vlxsam04
Tenant: gruppen-it
Collector: vlxsam04

[13:56:48] 1. Preparando diret√≥rios...
[13:56:48] 2. Testando conectividade...
[13:56:48] 3. Extraindo certificado CA...
[13:56:49] 4. Gerando chave privada...
[13:56:49] 5. Criando CSR...
[13:56:49] 6. Gerando certificado auto-assinado...
Certificate request self-signature ok
subject=CN = vlxsam04, O = SamurEye, OU = Collector
[13:56:49] 7. Configurando permiss√µes...
[13:56:49] 8. Registrando na API...
[13:56:49] ‚úÖ Registrado com sucesso (HTTP 200)
[13:56:49] 9. Criando configura√ß√£o...
[13:56:49] 10. Reiniciando servi√ßo...
[13:56:55] ‚úÖ Servi√ßo ativo

‚úÖ REGISTRO CONCLU√çDO!
Collector: vlxsam04
Certificados: /opt/samureye-collector/certs/
Configura√ß√£o: /etc/samureye-collector/.env

Teste: curl -k --cert /opt/samureye-collector/certs/collector.crt --key /opt/samureye-collector/certs/collector.key https://api.samureye.com.br/api/system/settings
[13:56:55] 5. Gerando Collector ID √∫nico...
[13:56:55] 6. Registrando collector na plataforma SamurEye...
info: No menu item 'Tentativa 1 de registro...' in node '(dir)Top'
root@vlxsam04:/opt/samureye-collector# /opt/samureye-collector/scripts/health-check.py
/opt/samureye-collector/scripts/health-check.py:41: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat(),
root@vlxsam04:/opt/samureye-collector#