root@vlxsam04:/opt/samureye-collector# curl -fsSL https://raw.githubusercontent.com/GruppenIT/SamurEye/refs/heads/main/docs/deployment/fix-vlxsam04-local.sh | sudo bash
🤖 Correção LOCAL vlxsam04 - Collector Agent
===========================================
[17:10:33] 🔍 Verificando SamurEye Collector Agent...
[17:10:33] ✅ Collector está rodando
[17:10:33] ⚠️ Detectados erros 404 nos logs - investigando...
[17:10:33] 🌐 Verificando conectividade com a plataforma...
[17:10:34] 🔒 Testando conectividade HTTPS (porta 443 apenas)...
[17:10:34] ✅ app.samureye.com.br acessível via HTTPS
[17:10:34] ✅ api.samureye.com.br acessível via HTTPS
[17:10:34] ✅ API principal acessível
[17:10:34] ✅ Endpoint heartbeat funcionando (200 OK)
[17:10:34] ⚙️ Verificando configuração do collector...
[17:10:34] ⚠️ Arquivo de configuração não encontrado
[17:10:34] 🆔 Collector ID: collector_id = self._get_collector_id()
[17:10:34] 🔧 Verificando/corrigindo configuração...
[17:10:34] ✅ Configuração atualizada
[17:10:34] 🗃️ Status será atualizado automaticamente via heartbeat...
[17:10:34] ℹ️ Collector enviará heartbeat para API e status será atualizado automaticamente
[17:10:34] 🔄 Reiniciando collector com nova configuração...
[17:10:50] ✅ Collector reiniciado com sucesso
[17:10:50] 📊 Monitorando logs por 30 segundos...
Aug 31 17:10:34 vlxsam04 systemd[1]: Stopping samureye-collector.service - SamurEye Collector Agent - vlxsam04...
Aug 31 17:10:34 vlxsam04 samureye-collector[121236]: 2025-08-31 17:10:34,086 - samureye-collector - INFO - Received signal 15, shutting down...
Aug 31 17:10:43 vlxsam04 samureye-collector[121236]: 2025-08-31 17:10:43,337 - samureye-collector - INFO - Collector agent stopped
Aug 31 17:10:43 vlxsam04 systemd[1]: samureye-collector.service: Deactivated successfully.
Aug 31 17:10:43 vlxsam04 systemd[1]: Stopped samureye-collector.service - SamurEye Collector Agent - vlxsam04.
Aug 31 17:10:45 vlxsam04 systemd[1]: Started samureye-collector.service - SamurEye Collector Agent - vlxsam04.
Aug 31 17:10:45 vlxsam04 samureye-collector[121410]: 2025-08-31 17:10:45,929 - samureye-collector - INFO - Starting SamurEye Collector Agent 1adc18ef-9cb4-4c8c-baaa-0d44357b6a6e
Aug 31 17:10:45 vlxsam04 samureye-collector[121410]: /opt/samureye-collector/collector_agent.py:147: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
Aug 31 17:10:45 vlxsam04 samureye-collector[121410]:   'timestamp': datetime.utcnow().isoformat(),
Aug 31 17:10:45 vlxsam04 samureye-collector[121410]: 2025-08-31 17:10:45,943 - samureye-collector - WARNING - Heartbeat failed: 404
^C
root@vlxsam04:/opt/samureye-collector#