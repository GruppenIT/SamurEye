Sources
=======
The package sources are available at:
https://github.com/deadsnakes/

Nightly Builds
==============

For nightly builds, see ppa:deadsnakes/nightly https://launchpad.net/~deadsnakes/+archive/ubuntu/nightly
More info: https://launchpad.net/~deadsnakes/+archive/ubuntu/ppa
Adding repository.
Found existing deb entry in /etc/apt/sources.list.d/deadsnakes-ubuntu-ppa-noble.sources
Hit:1 https://deb.nodesource.com/node_20.x nodistro InRelease
Hit:2 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:3 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:4 http://archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:5 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu noble InRelease
Hit:6 http://archive.ubuntu.com/ubuntu noble-backports InRelease
Reading package lists... Done
Hit:1 https://deb.nodesource.com/node_20.x nodistro InRelease
Hit:2 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:3 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:4 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu noble InRelease
Hit:5 http://archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:6 http://archive.ubuntu.com/ubuntu noble-backports InRelease
Reading package lists... Done
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
python3.11 is already the newest version (3.11.13-1+noble1).
python3.11-dev is already the newest version (3.11.13-1+noble1).
python3.11-venv is already the newest version (3.11.13-1+noble1).
python3.11-distutils is already the newest version (3.11.13-1+noble1).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
[10:09:32] âœ… Python 3.11.13 instalado
[10:09:32] âœ… Python padrÃ£o: 3.12.3
[10:09:32] ğŸ“¦ Instalando Node.js 20...
2025-09-03 10:09:32 - Installing pre-requisites
Hit:1 https://deb.nodesource.com/node_20.x nodistro InRelease
Hit:2 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:3 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:4 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu noble InRelease
Hit:5 http://archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:6 http://archive.ubuntu.com/ubuntu noble-backports InRelease
Reading package lists... Done
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
apt-transport-https is already the newest version (2.8.3).
ca-certificates is already the newest version (20240203).
curl is already the newest version (8.5.0-2ubuntu10.6).
gnupg is already the newest version (2.4.4-2ubuntu17.3).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Hit:1 https://deb.nodesource.com/node_20.x nodistro InRelease
Hit:2 http://archive.ubuntu.com/ubuntu noble InRelease
Hit:3 http://security.ubuntu.com/ubuntu noble-security InRelease
Hit:4 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu noble InRelease
Hit:5 http://archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:6 http://archive.ubuntu.com/ubuntu noble-backports InRelease
Reading package lists... Done
2025-09-03 10:09:38 - Repository configured successfully.
2025-09-03 10:09:38 - To install Node.js, run: apt-get install nodejs -y
2025-09-03 10:09:38 - You can use N|solid Runtime as a node.js alternative
2025-09-03 10:09:38 - To install N|solid Runtime, run: apt-get install nsolid -y

Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
nodejs is already the newest version (20.19.4-1nodesource1).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
[10:09:39] âœ… Node.js v20.19.4 instalado
[10:09:39] ğŸ‘¤ Criando usuÃ¡rio e estrutura de diretÃ³rios...
[10:09:39] âœ… Estrutura de diretÃ³rios criada
[10:09:39] ğŸ›¡ï¸ Instalando ferramentas de seguranÃ§a...
[10:09:39] ğŸ“¡ Configurando Nmap...
[10:09:39] ğŸ”„ Instalando Nmap (OBRIGATÃ“RIO para collector)...
[10:09:42] âœ… Nmap instalado via apt
[10:09:42] WARNING: âŒ CRÃTICO: Nmap nÃ£o disponÃ­vel - collector pode falhar
[10:09:42] âœ… Masscan configurado
[10:09:42]    VersÃ£o:
[10:09:42] ğŸ” Instalando Nuclei...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
[10:09:43] WARNING: âš ï¸ Nuclei via apt falhou, instalando via GitHub...
[10:09:45] âœ… Nuclei instalado via GitHub
[10:09:46] âœ… Nuclei configurado (vNuclei)
[10:09:46] ğŸ“‹ Atualizando templates Nuclei em background...
[10:09:46] ğŸ” Instalando Gobuster...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
gobuster is already the newest version (3.6.0-1ubuntu0.24.04.3).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
[10:09:46] âœ… Gobuster instalado via apt
[10:09:46] WARNING: âŒ Gobuster nÃ£o estÃ¡ disponÃ­vel apÃ³s instalaÃ§Ã£o
[10:09:46] ğŸ§¹ Arquivos temporÃ¡rios removidos
[10:09:46] ğŸ¤– Instalando agente coletor...
[10:09:46] ğŸ“¦ Instalando dependÃªncias Python...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
python3-psutil is already the newest version (5.9.8-2build2).
python3-requests is already the newest version (2.31.0+dfsg-1ubuntu1.1).
python3-venv is already the newest version (3.12.3-0ubuntu2).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
[10:09:47] âœ… DependÃªncias Python instaladas
[10:09:47] ğŸ”§ Configurando serviÃ§o systemd...
[10:09:48] âœ… ServiÃ§o systemd configurado
[10:09:48] â° Configurando cron jobs...
[10:09:48] âœ… Cron jobs configurados
[10:09:48] ğŸ”’ Configurando firewall...
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
ufw is already the newest version (0.36.2-6).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
Backing up 'user.rules' to '/etc/ufw/user.rules.20250903_100950'
Backing up 'before.rules' to '/etc/ufw/before.rules.20250903_100950'
Backing up 'after.rules' to '/etc/ufw/after.rules.20250903_100950'
Backing up 'user6.rules' to '/etc/ufw/user6.rules.20250903_100950'
Backing up 'before6.rules' to '/etc/ufw/before6.rules.20250903_100950'
Backing up 'after6.rules' to '/etc/ufw/after6.rules.20250903_100950'

Default incoming policy changed to 'deny'
(be sure to update your rules accordingly)
Default outgoing policy changed to 'allow'
(be sure to update your rules accordingly)
Rules updated
Rules updated (v6)
Rules updated
Rules updated
Rules updated (v6)
Firewall is active and enabled on system startup
[10:09:51] âœ… Firewall configurado
[10:09:51] ğŸš€ Iniciando serviÃ§o collector...
Created symlink /etc/systemd/system/multi-user.target.wants/samureye-collector.service â†’ /etc/systemd/system/samureye-collector.service.
[10:09:59] âœ… Templates Nuclei atualizados
[10:10:01] WARNING: âš ï¸ Collector pode ter problemas - verificar logs
[10:10:01] ğŸ§ª Executando testes de validaÃ§Ã£o...
[10:10:01] WARNING: âš ï¸ ServiÃ§o: Inativo
[10:10:01] âœ… Python: DependÃªncias OK
[10:10:01] ğŸ›¡ï¸ Ferramentas: nmap:âŒ nuclei:âœ… masscan:âœ… gobuster:âŒ
[10:10:01] âœ… API: Conectividade OK
[10:10:01] âœ… Logs: Sendo gerados
[10:10:01] ğŸ’“ Configurando correÃ§Ãµes de heartbeat e conectividade...
[10:10:01] WARNING: âš ï¸ Arquivo de configuraÃ§Ã£o /etc/samureye-collector/.env nÃ£o encontrado
[10:10:01] âœ… Script de teste de conectividade criado: /opt/samureye/collector/test-connectivity.sh
[10:10:01] WARNING: âš ï¸ Certificados nÃ£o encontrados - teste de conectividade pulado
[10:10:01] ğŸ“ Criando script de registro...
[10:10:01] ğŸ“ Sistema de registro integrado ao heartbeat implementado
[10:10:01] ğŸ”§ Implementando correÃ§Ã£o de duplicaÃ§Ã£o de coletores...
[10:10:02] âœ… Sistema anti-duplicaÃ§Ã£o integrado no install-hard-reset
[10:10:02] ğŸ”— Registrando collector com proteÃ§Ã£o anti-duplicaÃ§Ã£o...
[10:10:02] âœ… Registro automÃ¡tico serÃ¡ realizado pelo sistema de heartbeat
[10:10:02] ğŸ“‹ Criando scripts de diagnÃ³stico integrados...
[10:10:02] âœ… Script de diagnÃ³stico integrado criado

[10:10:02] ğŸ‰ HARD RESET DO COLLECTOR AGENT CONCLUÃDO!

ğŸ“‹ RESUMO DA INSTALAÃ‡ÃƒO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ¤– Collector Agent:
   â€¢ Status:  active
   â€¢ User:    samureye-collector
   â€¢ Dir:     /opt/samureye/collector
   â€¢ Logs:    /var/log/samureye-collector/

ğŸ Python 3.11:
   â€¢ Version: Python 3.12.3
   â€¢ Libs:    psutil, requests

ğŸ“¦ Node.js 20:
   â€¢ Version: v20.19.4

ğŸ›¡ï¸ Security Tools:
   â€¢ Nmap:     âŒ Ausente
   â€¢ Nuclei:   âœ… Instalado
   â€¢ Masscan:  âœ… Instalado
   â€¢ Gobuster: âŒ Ausente

ğŸ”§ Comandos Ãšteis:
   â€¢ Status:     systemctl status samureye-collector
   â€¢ Logs:       tail -f /var/log/samureye-collector/collector.log
   â€¢ Restart:    systemctl restart samureye-collector
   â€¢ Heartbeat:  /opt/samureye/collector/heartbeat.py
   â€¢ Cleanup:    /opt/samureye/collector/scripts/cleanup.sh
   â€¢ Test Conn:  /opt/samureye/collector/test-connectivity.sh
   â€¢ Check Status: /opt/samureye/collector/scripts/check-status.sh

ğŸ”— Conectividade:
   â€¢ API:       https://api.samureye.com.br
   â€¢ Gateway:   192.168.100.151

ğŸ’“ Heartbeat & Status:
   â€¢ Intervalo: 30 segundos (configurÃ¡vel em /etc/samureye-collector/.env)
   â€¢ Endpoint:  https://api.samureye.com.br/collector-api/heartbeat
   â€¢ Retry:     3 tentativas automÃ¡ticas por request
   â€¢ Timeout:   30 segundos por request HTTP

ğŸ“ PrÃ³ximos Passos:
   1. Monitorar logs: tail -f /var/log/samureye-collector/heartbeat.log
   2. Verificar status: /opt/samureye/collector/scripts/check-status.sh
   3. Interface admin: https://app.samureye.com.br/admin/collectors
   4. Aguardar transiÃ§Ã£o: ENROLLING â†’ ONLINE (1-2 minutos)

âœ… SISTEMA ANTI-DUPLICAÃ‡ÃƒO INTEGRADO:
   â€¢ Heartbeat robusto implementado para evitar coletores duplicados
   â€¢ Registro automÃ¡tico com proteÃ§Ã£o anti-duplicaÃ§Ã£o
   â€¢ TransiÃ§Ã£o automÃ¡tica: ENROLLING â†’ ONLINE â†’ (timeout) â†’ OFFLINE
   â€¢ Auto-recovery em caso de falhas de conexÃ£o

ğŸ”§ COMANDOS DE EXECUÃ‡ÃƒO REMOTA:
   curl -fsSL https://raw.githubusercontent.com/GruppenIT/SamurEye/refs/heads/main/docs/deployment/vlxsam04/install-hard-reset.sh | bash

root@vlxsam04:~# tail -f /var/log/samureye-collector/collector.log
2025-09-03 10:17:13,136 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
2025-09-03 10:17:23,354 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
2025-09-03 10:17:33,634 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
2025-09-03 10:17:43,884 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
2025-09-03 10:17:54,106 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
2025-09-03 10:18:04,368 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
2025-09-03 10:18:14,617 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
2025-09-03 10:18:24,874 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
2025-09-03 10:18:35,126 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
2025-09-03 10:18:45,361 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
2025-09-03 10:18:55,636 - ERROR - Erro ao carregar configuraÃ§Ã£o: [Errno 13] Permission denied: '/etc/samureye-collector/.env'
^C
root@vlxsam04:~#